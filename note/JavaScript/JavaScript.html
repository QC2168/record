<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>javascript进阶</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/record/assets/css/0.styles.781b7297.css" as="style"><link rel="preload" href="/record/assets/js/app.436f9468.js" as="script"><link rel="preload" href="/record/assets/js/3.c10ff59d.js" as="script"><link rel="preload" href="/record/assets/js/1.128bb0a8.js" as="script"><link rel="preload" href="/record/assets/js/62.1d933bdb.js" as="script"><link rel="prefetch" href="/record/assets/js/10.33d416ad.js"><link rel="prefetch" href="/record/assets/js/11.a649f9ac.js"><link rel="prefetch" href="/record/assets/js/12.a5b5d336.js"><link rel="prefetch" href="/record/assets/js/13.07dfc49b.js"><link rel="prefetch" href="/record/assets/js/14.51b4a2b0.js"><link rel="prefetch" href="/record/assets/js/15.3305cc14.js"><link rel="prefetch" href="/record/assets/js/16.8ff7075c.js"><link rel="prefetch" href="/record/assets/js/17.657443cc.js"><link rel="prefetch" href="/record/assets/js/18.ada3a64b.js"><link rel="prefetch" href="/record/assets/js/19.513590b5.js"><link rel="prefetch" href="/record/assets/js/20.eb98be55.js"><link rel="prefetch" href="/record/assets/js/21.e689459d.js"><link rel="prefetch" href="/record/assets/js/22.f3c641fc.js"><link rel="prefetch" href="/record/assets/js/23.239baad9.js"><link rel="prefetch" href="/record/assets/js/24.561dddbb.js"><link rel="prefetch" href="/record/assets/js/25.24fd33ca.js"><link rel="prefetch" href="/record/assets/js/26.5a2deb6c.js"><link rel="prefetch" href="/record/assets/js/27.a8204007.js"><link rel="prefetch" href="/record/assets/js/28.e390ea52.js"><link rel="prefetch" href="/record/assets/js/29.f73ec958.js"><link rel="prefetch" href="/record/assets/js/30.3a967e7d.js"><link rel="prefetch" href="/record/assets/js/31.8f5fbc33.js"><link rel="prefetch" href="/record/assets/js/32.c2fbb59c.js"><link rel="prefetch" href="/record/assets/js/33.0acb4ee6.js"><link rel="prefetch" href="/record/assets/js/34.d04b8247.js"><link rel="prefetch" href="/record/assets/js/35.200165e1.js"><link rel="prefetch" href="/record/assets/js/36.22dbac44.js"><link rel="prefetch" href="/record/assets/js/37.1e8f59f8.js"><link rel="prefetch" href="/record/assets/js/38.849c5233.js"><link rel="prefetch" href="/record/assets/js/39.f965c76a.js"><link rel="prefetch" href="/record/assets/js/4.554407db.js"><link rel="prefetch" href="/record/assets/js/40.7185db74.js"><link rel="prefetch" href="/record/assets/js/41.775e3833.js"><link rel="prefetch" href="/record/assets/js/42.a163a9e8.js"><link rel="prefetch" href="/record/assets/js/43.a5a1376d.js"><link rel="prefetch" href="/record/assets/js/44.40e30ec7.js"><link rel="prefetch" href="/record/assets/js/45.00b4adab.js"><link rel="prefetch" href="/record/assets/js/46.1ab12af2.js"><link rel="prefetch" href="/record/assets/js/47.22c4948e.js"><link rel="prefetch" href="/record/assets/js/48.302092fd.js"><link rel="prefetch" href="/record/assets/js/49.12677c02.js"><link rel="prefetch" href="/record/assets/js/5.cfa92093.js"><link rel="prefetch" href="/record/assets/js/50.f32ffac7.js"><link rel="prefetch" href="/record/assets/js/51.21d468c4.js"><link rel="prefetch" href="/record/assets/js/52.9aafe000.js"><link rel="prefetch" href="/record/assets/js/53.bdb6b0ed.js"><link rel="prefetch" href="/record/assets/js/54.47896b54.js"><link rel="prefetch" href="/record/assets/js/55.01d6347d.js"><link rel="prefetch" href="/record/assets/js/56.f89b4df6.js"><link rel="prefetch" href="/record/assets/js/57.7ef7bba2.js"><link rel="prefetch" href="/record/assets/js/58.92bfc24a.js"><link rel="prefetch" href="/record/assets/js/59.c59de5cc.js"><link rel="prefetch" href="/record/assets/js/6.f24e2b32.js"><link rel="prefetch" href="/record/assets/js/60.9f59ceae.js"><link rel="prefetch" href="/record/assets/js/61.6a7a26c5.js"><link rel="prefetch" href="/record/assets/js/63.d6ac12a9.js"><link rel="prefetch" href="/record/assets/js/64.a426efc6.js"><link rel="prefetch" href="/record/assets/js/65.2dc7a814.js"><link rel="prefetch" href="/record/assets/js/66.1dfb75f5.js"><link rel="prefetch" href="/record/assets/js/67.222d8771.js"><link rel="prefetch" href="/record/assets/js/68.0638eebe.js"><link rel="prefetch" href="/record/assets/js/69.de13ba25.js"><link rel="prefetch" href="/record/assets/js/7.e27df4fd.js"><link rel="prefetch" href="/record/assets/js/70.05721f98.js"><link rel="prefetch" href="/record/assets/js/71.98467212.js"><link rel="prefetch" href="/record/assets/js/72.a23ca44c.js"><link rel="prefetch" href="/record/assets/js/8.147dbad1.js"><link rel="prefetch" href="/record/assets/js/9.5d2f60e3.js">
    <link rel="stylesheet" href="/record/assets/css/0.styles.781b7297.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5419758c><div data-v-5419758c><div class="password-shadow password-wrapper-out" style="display:none;" data-v-00a07a82 data-v-5419758c data-v-5419758c><h3 class="title" data-v-00a07a82 data-v-00a07a82></h3> <p class="description" data-v-00a07a82 data-v-00a07a82></p> <label id="box" class="inputBox" data-v-00a07a82 data-v-00a07a82><input type="password" value="" data-v-00a07a82> <span data-v-00a07a82>Konck! Knock!</span> <button data-v-00a07a82>OK</button></label> <div class="footer" data-v-00a07a82 data-v-00a07a82><span data-v-00a07a82><i class="iconfont reco-theme" data-v-00a07a82></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-00a07a82>vuePress-theme-reco</a></span> <span data-v-00a07a82><i class="iconfont reco-copyright" data-v-00a07a82></i> <a data-v-00a07a82><span data-v-00a07a82>_island</span>
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-5419758c><header class="navbar" data-v-5419758c><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/record/" class="home-link router-link-active"><img src="/record/assets/avatar.jpg" alt="" class="logo"> <!----></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/record/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="/record/article/" class="nav-link"><i class="undefined"></i>
  文章
</a></div><div class="nav-item"><a href="/record/interview/" class="nav-link"><i class="undefined"></i>
  面试
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5419758c></div> <aside class="sidebar" data-v-5419758c><div class="personal-info-wrapper" data-v-158a94d9 data-v-5419758c><img src="/record/assets/avatar.jpg" alt="author-avatar" class="personal-img" data-v-158a94d9> <h3 class="name" data-v-158a94d9>
    _island
  </h3> <div class="num" data-v-158a94d9><div data-v-158a94d9><h3 data-v-158a94d9>42</h3> <h6 data-v-158a94d9>Articles</h6></div> <div data-v-158a94d9><h3 data-v-158a94d9>0</h3> <h6 data-v-158a94d9>Tags</h6></div></div> <ul class="social-links" data-v-158a94d9></ul> <hr data-v-158a94d9></div> <nav class="nav-links"><div class="nav-item"><a href="/record/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="/record/article/" class="nav-link"><i class="undefined"></i>
  文章
</a></div><div class="nav-item"><a href="/record/interview/" class="nav-link"><i class="undefined"></i>
  面试
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-00a07a82 data-v-5419758c><h3 class="title" data-v-00a07a82 data-v-00a07a82></h3> <!----> <label id="box" class="inputBox" data-v-00a07a82 data-v-00a07a82><input type="password" value="" data-v-00a07a82> <span data-v-00a07a82>Konck! Knock!</span> <button data-v-00a07a82>OK</button></label> <div class="footer" data-v-00a07a82 data-v-00a07a82><span data-v-00a07a82><i class="iconfont reco-theme" data-v-00a07a82></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-00a07a82>vuePress-theme-reco</a></span> <span data-v-00a07a82><i class="iconfont reco-copyright" data-v-00a07a82></i> <a data-v-00a07a82><span data-v-00a07a82>_island</span>
            
          <!---->
          2022
        </a></span></div></div> <div data-v-5419758c><main class="page" style="padding-right:0;"><section><div class="page-title"><h1 class="title">javascript进阶</h1> <div data-v-6013e732><i class="iconfont reco-account" data-v-6013e732><span data-v-6013e732>_island</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="javascript进阶"><a href="#javascript进阶" class="header-anchor">#</a> javascript进阶</h1> <h3 id="浏览器的工作原理"><a href="#浏览器的工作原理" class="header-anchor">#</a> 浏览器的工作原理</h3> <p>在浏览器中<code>JavaScript</code>代码是如何执行的</p> <p><code>js</code>也可以<code>node</code>里执行，因为里边有<code>v8</code>引擎</p> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202112222019125.png" alt="image-20211222201942856"></p> <ul><li>加载<code>html</code>文件（首先）
<ul><li>遇到<code>link</code>标签下载对应的<code>css</code>文件</li> <li>遇到<code>script</code>标签下载对应的<code>css</code>文件</li></ul></li></ul> <h4 id="浏览器内核"><a href="#浏览器内核" class="header-anchor">#</a> 浏览器内核</h4> <p>解析过程是经过浏览器内核处理</p> <p>不同浏览器是不同的内核组成的，内核也是浏览器非常重要的组成部分</p> <table><thead><tr><th>内核</th> <th>说明</th></tr></thead> <tbody><tr><td>Gecko</td> <td>早期<code>Netscape</code>和<code>Mozilla FireFox</code>浏览器使用</td></tr> <tr><td>Trident</td> <td>微软开发，<code>IE4-IE11</code>使用，<code>Edge</code>浏览器现使用<code>Blink</code></td></tr> <tr><td>Webkit</td> <td>苹果基于<code>KHTML</code>开发、开源，用于<code>Safari</code>，（<code>chrome</code>之前也在使用）</td></tr> <tr><td>Blink</td> <td>是<code>Webkit</code>的一个分支，<code>Google</code>开发，目前应用于<code>Google Chrome</code>、<code>Edge</code>、<code>Opera</code>等</td></tr></tbody></table> <h5 id="排版引擎"><a href="#排版引擎" class="header-anchor">#</a> 排版引擎</h5> <p><code>layout engine</code></p> <p>内核的另外一个叫法，也有称为浏览器引擎（<code>browser engine</code>），页面渲染引擎（<code>rendering engine</code>），样板引擎</p> <h4 id="浏览器渲染过程"><a href="#浏览器渲染过程" class="header-anchor">#</a> 浏览器渲染过程</h4> <p>加载html文件时，遇到script标签之后，会停止解析HTML，去加载执行JavaScript代码</p> <p>（JavaScript代码由js引擎处理）</p> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202112222033032.png" alt="image-20211222203338833"></p> <h4 id="javascript引擎"><a href="#javascript引擎" class="header-anchor">#</a> JavaScript引擎</h4> <ul><li>JavaScript是高级语言，最终需要被转成机器指令来执行</li> <li>我们编写的JavaScript代码无论是给浏览器 / Node执行，最后都是需要被CPU执行的</li> <li>但CPU只认识自己的指令集，即机器语言，才能被CPU所执行</li> <li>所以我们需要**<code>JavaScript</code>引擎<strong>把</strong><code>JavaScript</code>代码<strong>转化为</strong>CPU指令**来执行</li></ul> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202112222045233.png" alt="image-20211222204535128"></p> <p>常见的JavaScript引擎</p> <table><thead><tr><th>名称</th> <th>说明</th></tr></thead> <tbody><tr><td>SpiderMonkey</td> <td>第一款JavaScript引擎，由Brendan Eich开发（也就是JavaScript作者）</td></tr> <tr><td>Chakra</td> <td>微软开发，用于IE浏览器</td></tr> <tr><td>JavaScriptCore</td> <td>Webkit中的js引擎，小程序中也用到了，apple开发</td></tr> <tr><td>V8</td> <td>Google开发的，也帮助chrome从众多浏览器中脱颖而出</td></tr></tbody></table> <h4 id="浏览器内核和javascript引擎的关系"><a href="#浏览器内核和javascript引擎的关系" class="header-anchor">#</a> 浏览器内核和JavaScript引擎的关系</h4> <p>（ 以webkit为例 ）</p> <p>webCore负责HTML CSS解析、布局、渲染等工作</p> <p>JavaScriptCore 解析、执行JavaScript代码</p> <h4 id="v8引擎的原理"><a href="#v8引擎的原理" class="header-anchor">#</a> V8引擎的原理</h4> <p>V8是用C++开发的，是一个开源、高性能的JavaScript和WebAssembly引擎</p> <p>可以在多个平台运行，Win系统，macOS，使用X64、IA-21，ARM或者MIPS处理器的linux系统上运行</p> <p>V8使用得比较多的有Chrome和Node.js等</p> <p>V8可以独立运行，嵌套到任何C++程序中</p> <h5 id="v8引擎架构图"><a href="#v8引擎架构图" class="header-anchor">#</a> V8引擎架构图</h5> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202112222101126.png" alt="image-20211222210135934"></p> <div class="language- extra-class"><pre class="language-text"><code>const name = '张三'
</code></pre></div><p>V8引擎中的Parse或者PreParser会对这行代码进行词法分析，会生成一个tokens（是一个数组），每个值是一个对象<code>tokens:[{type:'keyword',value:'const'},{type:'identidfier',value:'name'} ...]</code></p> <p>划分出不同的类型之后，再进行语法分析生成AST抽象语法树（www.astexplorer.net 推荐一个在线生成AST抽象语法树）之后，经过ignition（V8引擎中一个库）转为<code>bytecode</code>字节码，V8再将组字节码（字节码是跨平台的）转换为CPU的指令集</p> <p>TurboFan库，收集函数执行的信息，会标签执行次数比较多的函数，并将这个函数优化成机器指令。（后续不再进行转换，提高性能）</p> <h5 id="相关模块说明"><a href="#相关模块说明" class="header-anchor">#</a> 相关模块说明</h5> <ul><li><p>Parse是一个解析器会将JavaScript代码转成AST</p> <ul><li>如果函数没有被调用，那么是不会被转换成AST的</li></ul></li> <li><p>PerParse预解析</p> <ul><li><p>不是所有JavaScript代码，在一开始就会被执行，如果对所有JavaScript代码进行解析，必然会影响页面运行效率</p></li> <li><p>所以有了**<code>lazy Parsing</code>** 延迟解析方案，它的作用是将不必要的函数进行预解析，只解析暂时需要的代码，而对函数的全量解析是在函数被调用时才会进行</p></li> <li><p>例如以下代码，对f2函数进行预解析处理</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> name<span class="token operator">=</span><span class="token string">'张三'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><p>Ignition是一个解释器，会将AST转换成ByteCode字节码</p> <ul><li>同时会收集TurboFan优化所需要的信息（例如函数参数的类型信息，有了类型才能进行真实的运算）</li> <li>如果函数只调用一次，Ignition会执行解析执行byteCode</li></ul></li> <li><p>TurboFan是一个编译器，可以将字节码编译为CPU可以直接执行的机器码</p> <ul><li>如果一个函数被多次调用，那么就会被标记为热点函数，并经过TurboFan转换成优化的机器码，提高代码的执行性能</li> <li>后续如果执行函数过程中，类型发生了变化，之前优化的机器码不能正确处理，就会逆向转换为字节码</li></ul></li></ul> <h3 id="全局代码执行"><a href="#全局代码执行" class="header-anchor">#</a> 全局代码执行</h3> <h3 id="变量环境-记录"><a href="#变量环境-记录" class="header-anchor">#</a> 变量环境 / 记录</h3> <h4 id="早期ecma的版本规范"><a href="#早期ecma的版本规范" class="header-anchor">#</a> 早期ECMA的版本规范</h4> <p>AO / GO</p> <p>VO : GO</p> <p>VO : AO</p> <p>ECMAScript5 之前</p> <p>每一个执行上下文会被关联到一个变量对象（Variable object，VO），在源代码中的变量和函数声明会被作为属性添加到VO中。对于函数来说，参数也会被添加到VO中</p> <h4 id="最新ecma的版本规范"><a href="#最新ecma的版本规范" class="header-anchor">#</a> 最新ECMA的版本规范</h4> <p>Variable Environment 变量环境</p> <p>每一个执行上下文会关联到一个变量环境（variable environment）中，在执行代码中变量和函数的声明会作为环境记录（environment record）添加到变量环境中，对于函数来说，参数也会被作为环境记录添加到变量记录中</p> <h3 id="认识内存管理"><a href="#认识内存管理" class="header-anchor">#</a> 认识内存管理</h3> <p>不管什么样的编程语言，在代码执行过程中都是需要给他分配内存的，不同的是某些编程语言需要我们手动的管理内存，某些编程语言会可以自动帮助我们管理内存</p> <h4 id="磁盘-to-内存-to-cpu"><a href="#磁盘-to-内存-to-cpu" class="header-anchor">#</a> <strong>磁盘 TO 内存 TO CPU</strong></h4> <h5 id="内存管理生命周期"><a href="#内存管理生命周期" class="header-anchor">#</a> 内存管理生命周期</h5> <ol><li>分配申请你需要的内存（申请）</li> <li>使用分配的内存（存放数据，比如对象等）</li> <li>不需要使用时，对其进行释放</li></ol> <blockquote><p>JavaScript通常情况下是不需要手动来管理的（还有java、JavaScript、python、swift、dart等，它们都会自动帮助我们管理内存），手动管理（C、C++，早期OC）</p></blockquote> <ul><li>javaScript会在定义变量时为我们<strong>分配内存</strong></li> <li>内存分配方式的不同
<ul><li>JS对于<strong>基本数据类型</strong>内存的分配会在执行时<strong>直接在栈空间分配</strong></li> <li>JS对于<strong>复杂数据类型</strong>内存的分配会在栈内存中<strong>开辟一块空间</strong>，并且将这块空间的<strong>指针返回值变量引用</strong></li></ul></li></ul> <h5 id="垃圾回收"><a href="#垃圾回收" class="header-anchor">#</a> 垃圾回收</h5> <ul><li><p><strong>内存大小有限</strong>，当内存不再需要时，需要<strong>对其进行释放</strong>，以便<strong>腾出更多内存</strong>空间</p></li> <li><p>在手动管理内存的语言中，我们需要<strong>通过一些方式来进行内存释放</strong>，例如free函数：</p> <ul><li>这种管理方式<strong>效率非常低</strong>，影响我们编写<strong>逻辑代码的效率</strong></li> <li>并且这种方式对开发者要求也很高，并且<strong>一不小心就会产生内存泄漏</strong></li></ul></li> <li><p>所以大部分现代编程语言都有自己的垃圾回收机制</p> <ul><li>垃圾回收 英文是<strong>Garbage Collection</strong> 简称GC</li> <li>对于那些<strong>不再使用的对象</strong>，都称之为<strong>垃圾</strong>，需要被<strong>回收</strong>，以<strong>释放更多的内存</strong>空间</li> <li>而我们的语言运行环境，比如java运行环境JVM，JavaScript运行环境js引擎都有垃圾回收器</li> <li>垃圾回收器简称<strong>GC</strong>，很多地方看到<strong>GC</strong>其实就是垃圾回收器</li></ul></li> <li><p>GC算法</p> <ul><li>引用技术</li> <li>标记清除
<ul><li>设置一个根对象（root object），垃圾回收器会定期从这个根开始，找所有从根开始有引用到的对象，对于哪些没有引用到的对象，就认为不可用对象（不可达对象）</li> <li>这个算法很好解决了循环引用问题</li> <li>js引擎比较广泛的采用标记清除算法，当然类似于V8引擎为了进行更好优化，它在算法实现细节上也会结合一些其他算法，进行选择</li></ul></li></ul></li></ul> <h3 id="js函数"><a href="#js函数" class="header-anchor">#</a> JS函数</h3> <p>jS中是函数一等公民</p> <p>一等公民说明这个东西很灵活，函数作为参数、返回值</p> <ul><li>在JavaScript中，函数是非常重要的，并且是一等公民
<ul><li>那么就意味着函数的使用是非常灵活</li> <li>函数可以作为另外一个函数的参数，也可以作为另外一个函数的返回值来使用</li></ul></li> <li>自己编写高阶函数</li> <li>使用内置的高阶函数</li> <li>vue3（composition api）和react（hooks）也开始使用函数式编程</li></ul> <h3 id="javascript中闭包的定义"><a href="#javascript中闭包的定义" class="header-anchor">#</a> JavaScript中闭包的定义</h3> <ul><li>计算机科学中的定义
<ul><li>闭包（Closure），称为<strong>词法闭包</strong>（Lexical Closure）或者<strong>函数闭包</strong>（function closure）</li> <li>是在支持头等函数（<strong>作为第一公民</strong>）的编程语言中，实现词法绑定的一种技术</li> <li>闭包在实现上是一个<strong>结构体</strong>，它存储了<strong>一个函数和一个关联的环境</strong>（相当于一个符号查找表）</li> <li>闭包跟函数最大的区别在于，在捕捉闭包的时候，它的<strong>自由变量</strong>会在捕捉时被确定，这样即使脱离了捕捉时的上下文，它也能照常运行（<strong>这句话是核心</strong>）</li></ul></li> <li>闭包的概念出现于60年代，最早实现闭包的程序是Scheme，那么我们就可以理解为什么JavaScript中有闭包
<ul><li>因为JavaScript中有大量的设计是来源于Scheme</li></ul></li> <li>MDN对闭包解释
<ul><li>一个函数和对其周围状态（<code>lexical environment</code>，<strong>词法环境</strong>）的引用捆绑在一起（或者说函数被引用包围），这样子的组合就是<strong>闭包</strong>（closure）；</li> <li>也就是说，闭包让你可以在一个内层函数中访问到其外层函数的作用域</li> <li>在JavaScript中，<strong>每当创建一个函数，闭包就会在函数创建时同时被创建出来</strong></li></ul></li> <li>总结
<ul><li>一个普通的函数function，如果它可以访问外层作用于的自由变量，那么这个函数就是一个闭包</li> <li>从广义的角度来说，JavaScript中的函数都是闭包</li> <li>从狭义的角度来说，JavaScript中一个函数，如果访问了外层作用域的变量，那么它就是一个闭包</li></ul></li></ul> <h3 id="闭包内存泄漏"><a href="#闭包内存泄漏" class="header-anchor">#</a> 闭包内存泄漏</h3> <h3 id="闭包内存回收"><a href="#闭包内存回收" class="header-anchor">#</a> 闭包内存回收</h3> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202112282106110.png" alt="image-20211228210643885"></p> <div class="language- extra-class"><pre class="language-text"><code>setTimeout(() =&gt; {
  arrayFns=null
}, 3000);
</code></pre></div><p><img src="https://gitee.com/QC2168/note-img/raw/master/202112282113310.png" alt="image-20211228211300204"></p> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202112282117754.png" alt="image-20211228211726580"></p> <h3 id="为什么需要this"><a href="#为什么需要this" class="header-anchor">#</a> 为什么需要this</h3> <ul><li><p>在常见的编程语言中，几乎都有this这个关键字（Objective-C中使用的是self），但是JavaScript中的this和常见的面向对象语言的this不太一样</p> <ul><li><p>常见面向对象的编程语言中，比如java，C++，Swift，Dart等等一系列语言中，this通常只会出现在类方法中</p></li> <li><p>也就是你需要有一个类，类中方法（特别是实例方法）中，this代表的是当前调用对象</p></li> <li><p>但是JavaScript中的this更加灵活，无论是它出现的位置还是它代表的含义</p></li> <li><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">{</span>
	<span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hxh'</span><span class="token punctuation">,</span>
	<span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// 当前实例对象</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li></ul> <h3 id="this的作用"><a href="#this的作用" class="header-anchor">#</a> this的作用</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hxh'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在吃东西'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在跑步'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">studying</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在学习'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 从某些角度来说，开发中如果没有obj，很多的问题我们也是有解决方案的</span>
<span class="token comment">// 但是如果没有this，会让我们编写代码变得非常不方便</span>
obj<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span><span class="token function">studying</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hxh'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">eating</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在吃东西'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">running</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在跑步'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">studying</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在学习'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="this指向什么"><a href="#this指向什么" class="header-anchor">#</a> this指向什么</h3> <ol><li>函数在调用时，JavaScript会默认给this绑定一个值</li> <li>this的绑定和定义的位置是没有关系的</li> <li>this1的绑定和调用方式以及调用位置有关系</li> <li>this是在运行时被绑定的</li></ol> <h3 id="全局作用域中的this指向"><a href="#全局作用域中的this指向" class="header-anchor">#</a> 全局作用域中的this指向</h3> <p>大多数情况下，this都是出现在函数中的，而在全局作用域中也有this</p> <ul><li>浏览器中全局作用域中的this指向<code>window</code> （<code>globalObject</code>）</li> <li>NODE中全局作用域中的this指向 <code>{}</code> （空对象）
<ul><li>因为在<code>node</code>执行的时候，<code>node</code>会把这个<code>js</code>文件当成一个模块，加载模块，编译代码，放到一个函数里面.<code>apply</code>({})</li> <li>在<code>node</code>环境下如果执行打印<code>window</code>会报错<code>no defined</code></li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>浏览器环境：
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
Node环境：
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在node会报错, no defined</span>
</code></pre></div><h3 id="this绑定规则"><a href="#this绑定规则" class="header-anchor">#</a> this绑定规则</h3> <h4 id="默认绑定"><a href="#默认绑定" class="header-anchor">#</a> 默认绑定</h4> <ul><li>独立的函数调用可以理解成函数没有被绑定到某个对象上进行调用</li></ul> <h5 id="默认绑定的案例一"><a href="#默认绑定的案例一" class="header-anchor">#</a> 默认绑定的案例一</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 默认绑定，是一个独立函数，没有绑定对象</span>
<span class="token comment">// 指向window</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="默认绑定的案例二"><a href="#默认绑定的案例二" class="header-anchor">#</a> 默认绑定的案例二</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
  <span class="token function">foo1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">foo3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
  <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">foo3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="默认绑定的案例三"><a href="#默认绑定的案例三" class="header-anchor">#</a> 默认绑定的案例三</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hxh'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">foo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> bar<span class="token operator">=</span>obj<span class="token punctuation">.</span>foo
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// {name: 'hxh', foo: ƒ}</span>
<span class="token comment">// 和位置没有关系</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// window</span>
</code></pre></div><h5 id="默认绑定的案例四"><a href="#默认绑定的案例四" class="header-anchor">#</a> 默认绑定的案例四</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;hxh&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span> foo
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token comment">// 和位置没有关系</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// window</span>
</code></pre></div><h5 id="默认绑定的案例五"><a href="#默认绑定的案例五" class="header-anchor">#</a> 默认绑定的案例五</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> fn<span class="token operator">=</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">// 也是独立调用fn() // window</span>
</code></pre></div><h5 id="默认绑定的案例六"><a href="#默认绑定的案例六" class="header-anchor">#</a> 默认绑定的案例六</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token literal-property property">eating</span><span class="token operator">:</span>fn <span class="token comment">// 隐式绑定}obj.eating() // {eating: ƒ}</span>
</code></pre></div><h4 id="隐式绑定"><a href="#隐式绑定" class="header-anchor">#</a> 隐式绑定</h4> <ul><li>它的调用位置是通过某个对象发起的函数调用，例如<code>obj2.bar()</code></li> <li>object对象会被js引擎绑定到fn函数中this里面</li></ul> <h5 id="隐式绑定的案例一"><a href="#隐式绑定的案例一" class="header-anchor">#</a> 隐式绑定的案例一</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">// 独立函数调用// foo()var obj={  name:'hxh',  foo:foo}obj.foo() // obj对象</span>
</code></pre></div><h5 id="隐式绑定的案例二"><a href="#隐式绑定的案例二" class="header-anchor">#</a> 隐式绑定的案例二</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hxh'</span><span class="token punctuation">,</span>  <span class="token function-variable function">eating</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在吃东西'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token function-variable function">running</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在跑步'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>obj<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>obj<span class="token punctuation">.</span><span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">var</span> fn<span class="token operator">=</span>obj<span class="token punctuation">.</span><span class="token function">eatingfn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取不到this.name，this指向fn</span>
</code></pre></div><h5 id="隐式绑定的案例三"><a href="#隐式绑定的案例三" class="header-anchor">#</a> 隐式绑定的案例三</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj1<span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'obj1'</span><span class="token punctuation">,</span>  <span class="token function-variable function">foo</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">var</span> obj2<span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'obj2'</span><span class="token punctuation">,</span>  <span class="token literal-property property">bar</span><span class="token operator">:</span>obj1<span class="token punctuation">.</span>foo<span class="token punctuation">}</span>obj2<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// obj2对象</span>
</code></pre></div><h4 id="显示绑定"><a href="#显示绑定" class="header-anchor">#</a> 显示绑定</h4> <ul><li>前提条件
<ul><li>必须在调用的对象内部有一个对函数的引用（比如一个属性）</li> <li>假使没有这样引用，在进行调用时，会报找不到该函数的错误</li> <li>正是通过这个引用，间接的将this绑定到这个对象上</li></ul></li> <li>如果不希望在对象内部包含这个函数的引用，同时又希望在这个对象上强制调用
<ul><li>JavaScript所有的函数都可以使用call和apply方法（这个和prototype有关）</li> <li>这两个函数的第一个参数都要求是一个对象，这个对象是给this准备的</li> <li>调用这个函数时，会将this绑定到这个传入的对象上</li></ul></li></ul> <h5 id="显示绑定的案例-call-apply"><a href="#显示绑定的案例-call-apply" class="header-anchor">#</a> 显示绑定的案例 | call apply</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'函数被调用了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'obj'</span><span class="token punctuation">}</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// windowfoo.call(obj) // objfoo.apply(obj) // objfoo.apply('aaa') // aaa// call和apply有什么区别// call和apply在执行函数时，是可以明确的绑定this，这个绑定规则称之为显示绑定function sum(num1,num2){  console.log(num1+num2,this);}sum(10,20)sum.call('call',10,20)sum.apply('apply',[10,20])</span>
</code></pre></div><ul><li>foo直接调用和call / apply调用的不同在于this绑定的不同</li> <li>foo直接调用指向的是全局对象（window）</li></ul> <p>显示绑定的案例 | bind</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>foo<span class="token punctuation">.</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span> <span class="token comment">// 'aaa'</span>
</code></pre></div><ul><li>默认绑定和显示绑定bind会发生冲突，之所以优先级为 显示绑定高于默认绑定</li></ul> <blockquote><p>bind会在堆内容开辟一块新的空间来存放这个新的函数</p></blockquote> <h4 id="new绑定"><a href="#new绑定" class="header-anchor">#</a> new绑定</h4> <ul><li>JavaScript中的函数可以当做一个类的构造函数来使用，也就是使用new关键字</li> <li>使用new关键字来调用函数是，会执行如下的操作
<ul><li>创建一个全新的对象，内部将调用一个函数时（构造器）</li> <li>这个新对象会被执行prototype连接</li> <li>这个新对象会绑定到函数调用的this上（<strong>this的绑定在这个步骤完成</strong>）</li> <li>如果函数没有返回其他对象，表达式会返回这个新对象</li></ul></li></ul> <h5 id="new绑定的案例"><a href="#new绑定的案例" class="header-anchor">#</a> new绑定的案例</h5> <div class="language- extra-class"><pre class="language-text"><code>function Person(name,age) {  this.name=name  this.age=age  return this;}var p1 = new Person('hxh',21);console.log(p1.name,p1.age);
</code></pre></div><h4 id="规律优先级"><a href="#规律优先级" class="header-anchor">#</a> 规律优先级</h4> <ul><li>默认规则优先级最低</li> <li>显示绑定优先级高于隐式绑定</li> <li>new绑定优先级高于隐式绑定</li> <li>new绑定优先级高于bind
<ul><li>new绑定和call、apply是不允许同时使用的，所以不存在谁的优先级更高</li> <li>new绑定可以和bind一起使用，new绑定优先级更高</li></ul></li></ul> <p>new绑定 -&gt; 显示绑定 -&gt; 隐式绑定</p> <h3 id="this规则之外"><a href="#this规则之外" class="header-anchor">#</a> this规则之外</h3> <h4 id="忽略显示绑定"><a href="#忽略显示绑定" class="header-anchor">#</a> 忽略显示绑定</h4> <h4 id="es6箭头函数"><a href="#es6箭头函数" class="header-anchor">#</a> ES6箭头函数</h4> <ul><li>箭头函数不使用this的四种标准规则（也就是不绑定this），而是根据外层作用域来决定this</li></ul> <h3 id="箭头函数-arrow-function"><a href="#箭头函数-arrow-function" class="header-anchor">#</a> 箭头函数 arrow function</h3> <ul><li>箭头函数是<strong>ES6之后增加</strong>的一种编写函数的方法，并且它比函数表达式要更加简洁：
<ul><li>箭头函数<strong>不会绑定this、arguments属性</strong></li> <li>箭头函数不能作为构造函数来使用（<strong>不能和new一起来使用，会抛出错误</strong>）</li></ul></li></ul> <h3 id="实现apply、call、bind函数"><a href="#实现apply、call、bind函数" class="header-anchor">#</a> 实现apply、call、bind函数</h3> <p><img src="https://gitee.com/QC2168/note-img/raw/master/202201021614548.png" alt="image-20220102161416445"></p> <p>apply call bind 绑定的this对象，在内部保存的是内存地址</p> <blockquote><p>注意：练习函数、this、调用关系，不考虑一些边界情况，其实它底层实现是C++代码，但这里我们通过JavaScript来模拟这些函数</p></blockquote> <h4 id="call实现"><a href="#call实现" class="header-anchor">#</a> call实现</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mycall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;mycall被调用了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取需要被执行的函数</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token comment">// 对thisArg转成对象类型（防止传入的是非对象类型）</span>
  thisArg <span class="token operator">=</span> thisArg <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">)</span> <span class="token operator">:</span> window<span class="token punctuation">;</span>
  <span class="token comment">//调用需要被执行的函数</span>
  thisArg<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn<span class="token punctuation">;</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> thisArg<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 删除属性</span>
  <span class="token keyword">delete</span> thisArg<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>

  <span class="token comment">// 将最终的结果返回出去</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="apply实现"><a href="#apply实现" class="header-anchor">#</a> apply实现</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myapply</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取需要被执行的函数</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token comment">// 将thisArg转成对象</span>
  thisArg <span class="token operator">=</span> thisArg <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> thisArg <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">)</span> <span class="token operator">:</span> window<span class="token punctuation">;</span>
  <span class="token comment">// 调用需要执行的函数</span>
  thisArg<span class="token punctuation">.</span>fn<span class="token operator">=</span>fn
  <span class="token keyword">var</span> result<span class="token operator">=</span>thisArg<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token comment">// 删除属性</span>
  <span class="token keyword">delete</span> thisArg<span class="token punctuation">.</span>fn
  <span class="token comment">// 返回数据</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;sum被调用&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="bind实现"><a href="#bind实现" class="header-anchor">#</a> bind实现</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mybind</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">thisArg<span class="token punctuation">,</span> <span class="token operator">...</span>argArray</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取到真实需要调用的函数</span>
  <span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token comment">// 绑定this</span>
  thisArg <span class="token operator">=</span> thisArg <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> thisArg <span class="token operator">!==</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token function">Object</span><span class="token punctuation">(</span>thisArg<span class="token punctuation">)</span> <span class="token operator">:</span> window<span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">proxyFn</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将函数放到thisArg中进行调用</span>
    thisArg<span class="token punctuation">.</span>fn <span class="token operator">=</span> fn<span class="token punctuation">;</span>
    <span class="token comment">// 特殊情况，将传入的两个数组进行合并</span>
    <span class="token keyword">var</span> finalArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>argArray<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> thisArg<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>finalArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> thisArg<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 返回结果</span>
  <span class="token keyword">return</span> proxyFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="arguments"><a href="#arguments" class="header-anchor">#</a> arguments</h3> <ul><li>arguments是一个对应传递给函数的参数的类数组（<code>array-like</code>）对象</li> <li>array-like意味着它不是一个数组类型，而是一个对象类型
<ul><li>但它却拥有一些特性，比如length比如可以通过index来访问</li> <li>但它却没有数组的一些方法，比如<code>forEach</code>、<code>map</code>等</li></ul></li></ul> <h3 id="理解javascript纯函数"><a href="#理解javascript纯函数" class="header-anchor">#</a> 理解JavaScript纯函数</h3> <p>函数式编程中有个非常重要的概念叫纯函数，JavaScript符合函数式编程的范式，所以也有纯函数的概念</p> <ul><li>在react开发中纯函数是被多次提及的</li> <li>比如react中组件就被要求像是一个纯函数，redux中有一个reducer的概念，也是要求必须是纯函数</li> <li>所以掌握纯函数对于理解很多框架的设计是非常有帮助的</li></ul> <p>纯函数的维基百科定义</p> <ul><li>在程序设计中，若一个函数符合以下条件，那么这个函数被称为函数</li> <li>此函数在<strong>相同的输入值时</strong>，需产生相同的<strong>输出</strong></li> <li>函数的<strong>输出和输入值以外的其他隐藏信息或状态无关</strong>，也和由<strong>IO设备产生的外部输出无关</strong></li> <li>该函数不能<strong>有语义上可观察的函数副作用</strong>，例如“<strong>触发事件</strong>”，使输出设备输出，或更改输出值以外物件的内容等</li></ul> <p>总结一下</p> <ul><li>确定的输入，一定会产生确定的输出</li> <li>函数在执行过程中，不能产生副作用</li></ul> <h4 id="副作用的理解"><a href="#副作用的理解" class="header-anchor">#</a> 副作用的理解</h4> <ul><li>副作用英文为side effect，这里表示在<strong>执行一个函数</strong>时，除了返回函数值之外，还对<strong>调用函数产生了附加的影响</strong>，比如<strong>修改全局变量</strong>，<strong>修改参数</strong>，<strong>改变外部的存储</strong></li> <li>副作用往往是产生BUG的温床</li></ul> <h4 id="纯函数"><a href="#纯函数" class="header-anchor">#</a> 纯函数</h4> <ul><li><p>slice 截取数组的时候不会对原数组进行任何</p> <ul><li><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token string">'cba'</span><span class="token punctuation">,</span><span class="token string">'df'</span><span class="token punctuation">,</span><span class="token string">'zs'</span><span class="token punctuation">]</span>

<span class="token comment">// slice 生成新数组，原数组不动  这里是纯函数</span>
<span class="token keyword">var</span> newNames1<span class="token operator">=</span>names<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNames1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'abc', 'cba', 'df' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'abc', 'cba', 'df', 'zs' ]</span>
</code></pre></div></li></ul></li> <li><p>splice 截取数组的时候会对原数组进行操作，所以不是一个纯函数</p> <ul><li><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// splice 会修改原数组 （产生副作用）</span>
<span class="token comment">// 不符合纯函数的要求</span>
<span class="token comment">// 在开发的时候尽量使用纯函数</span>
<span class="token keyword">var</span> newNames2<span class="token operator">=</span>names<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNames2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'df', 'zs' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 'df', 'zs' ]</span>
</code></pre></div></li></ul></li></ul> <h4 id="练习纯函数的案例"><a href="#练习纯函数的案例" class="header-anchor">#</a> 练习纯函数的案例</h4> <h5 id="foo"><a href="#foo" class="header-anchor">#</a> foo</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// foo是纯函数</span>
<span class="token comment">// 相同的输入一定的产生相同的输出</span>
<span class="token comment">// 没有修改外界的数据</span>
<span class="token comment">// 在执行时不会产生副作用</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span>num2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> num1<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>num2<span class="token operator">*</span>num2
<span class="token punctuation">}</span>
</code></pre></div><h5 id="bar"><a href="#bar" class="header-anchor">#</a> bar</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// bar不是纯函数</span>
<span class="token comment">// 修改了外界的变量</span>
<span class="token keyword">var</span> name<span class="token operator">=</span><span class="token string">'hxh'</span> 
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'bar其他代码执行'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  name<span class="token operator">=</span><span class="token string">'abc'</span>
<span class="token punctuation">}</span>

<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// abc</span>
</code></pre></div><h5 id="baz"><a href="#baz" class="header-anchor">#</a> baz</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// baz不是一个纯函数</span>
<span class="token comment">// 修改了外面对象的值</span>
<span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  info<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">100</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'hxh'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>

<span class="token function">baz</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 修改了原来的值</span>
<span class="token comment">// { name: 'hxh', age: 100 }</span>
</code></pre></div><h5 id="test"><a href="#test" class="header-anchor">#</a> test</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// test是一个纯函数</span>
<span class="token comment">// 没有修改其他值</span>
<span class="token comment">// 相同的输入一定的产生相同的输出</span>
<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>info<span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">100</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">test</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { name: 'hxh', age: 100 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { name: 'hxh', age: 18 }</span>
</code></pre></div><h5 id="特殊"><a href="#特殊" class="header-anchor">#</a> 特殊</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">printInfo</span><span class="token punctuation">(</span><span class="token parameter">info</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 严格来说，它不是纯函数（有输出）</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>name<span class="token punctuation">,</span>info<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  info<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'abc'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="纯函数的优点"><a href="#纯函数的优点" class="header-anchor">#</a> 纯函数的优点</h4> <ul><li>纯函数在函数式编程中非常<strong>重要</strong> <ul><li>可以<strong>安心的编写和使用</strong>（不会影响外部的数据）</li> <li>在<strong>写纯函数的时候</strong>保证了函数的纯度，<strong>只单纯实现自己的业务逻辑</strong>即可，<strong>不需要关心</strong>传入的内容是<strong>任何获取</strong>或者<strong>依赖其他外部变量</strong>是否已经发生了改变</li> <li>在<strong>用的时候</strong>，确定<strong>你的输入内容不会被任意篡改</strong>，并且<strong>自己确定的输入</strong>，一定会<strong>有确定的输出</strong></li></ul></li></ul> <h3 id="javascript柯里化"><a href="#javascript柯里化" class="header-anchor">#</a> JavaScript柯里化</h3> <ul><li><p>柯里化也是属于函数式编程里面一个非常重要的概念</p> <ul><li>在计算机科学中，<strong>柯里化</strong>（Currying），又译为<strong>卡瑞化</strong>、<strong>加里化</strong></li> <li>把接收的<strong>多个参数的函数</strong>，变成<strong>接收一个单一参数</strong>（最初函数的第一个参数）的函数，并且返回<strong>接收余下的参数</strong>，而且<strong>返回结果的新函数的计数</strong></li> <li>柯里化声称“<strong>如果你固定某些参数，你将得到接收余下参数的一个函数</strong></li></ul></li> <li><p>柯里化总结</p> <ul><li><strong>只传递给函数一部分参数来调用它，让它返回一个函数去处理剩余的参数</strong></li> <li>这个过程就称之为<strong>柯里化</strong></li></ul></li></ul> <h5 id="柯里化过程"><a href="#柯里化过程" class="header-anchor">#</a> 柯里化过程</h5> <p>拆分函数参数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span>

<span class="token comment">// 柯里化的过程</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="柯里化的作用"><a href="#柯里化的作用" class="header-anchor">#</a> 柯里化的作用</h5> <h6 id="让函数的职责单一"><a href="#让函数的职责单一" class="header-anchor">#</a> 让函数的职责单一</h6> <ul><li>在函数式编程中，一个函数只<strong>处理一个问题</strong>，而不是将<strong>很多个问题交给一个函数来处理</strong>（<strong>单一职责原则</strong>）</li> <li>我们是否就可以<strong>将每次传入的参数在单一的函数中进行处理</strong>，处理完之后在下一个函数中再使用处理后的结果</li></ul> <h6 id="例子一"><a href="#例子一" class="header-anchor">#</a> 例子一</h6> <p>假如，我们需要经常把一个数字5和另外一个数字进行相加操作。</p> <p><strong>普通做法</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span>n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> m<span class="token operator">+</span>n
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>柯里化</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">makeAdder</span><span class="token operator">=</span><span class="token parameter">count</span><span class="token operator">=&gt;</span><span class="token parameter">num</span><span class="token operator">=&gt;</span>count<span class="token operator">+</span>num<span class="token punctuation">;</span>

<span class="token keyword">var</span> res<span class="token operator">=</span><span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> adder5<span class="token operator">=</span><span class="token function">makeAdder</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">adder5</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h6 id="例子二"><a href="#例子二" class="header-anchor">#</a> 例子二</h6> <p>在项目中我们封装了一个常用的方法log，在正常使用的情况下，前面两个参数传入是一致的，此时我们可以使用柯里化来优化以下代码段</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">date<span class="token punctuation">,</span>type<span class="token punctuation">,</span>msg</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">][</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]:[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'DEBUG'</span><span class="token punctuation">,</span><span class="token string">'查找一个到BUG'</span><span class="token punctuation">)</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'DEBUG'</span><span class="token punctuation">,</span><span class="token string">'查找一个到BUG'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>柯里化</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">log</span><span class="token operator">=</span><span class="token parameter">date</span><span class="token operator">=&gt;</span><span class="token parameter">type</span><span class="token operator">=&gt;</span><span class="token parameter">msg</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">][</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>type<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]:[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> defineLog<span class="token operator">=</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">defineLog</span><span class="token punctuation">(</span><span class="token string">'DEBUG'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'找到一个BUG'</span><span class="token punctuation">)</span>
<span class="token function">defineLog</span><span class="token punctuation">(</span><span class="token string">'DEBUG'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'找到一个BUG'</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="实现柯里化"><a href="#实现柯里化" class="header-anchor">#</a> 实现柯里化</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">hyCurrying</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">curried</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断当前已经接收到的参数的个数，和参数本身需要接收的参数一致</span>
    <span class="token comment">// 1.当已经传入的参数，大于等于 需要的参数时，就执行函数</span>
    <span class="token comment">// console.log(args.length);</span>
    <span class="token comment">// fn有个length属性，可以通过这个属性获取参数</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> fn<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 没有达到个数时，需要返回一个新的函数，继续来接收的参数</span>
      <span class="token keyword">function</span> <span class="token function">curried2</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 接收到参数之后，递归调用curried函数检查函数的个数是否达到要求</span>
        <span class="token keyword">return</span> <span class="token function">curried</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>args2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> curried2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> curried<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用封装的柯里化函数，将我们的方法传入即可</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> curryAdd <span class="token operator">=</span> <span class="token function">hyCurrying</span><span class="token punctuation">(</span>add1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r1<span class="token operator">=</span><span class="token function">add1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r2<span class="token operator">=</span><span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> r3<span class="token operator">=</span><span class="token function">curryAdd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="组合函数"><a href="#组合函数" class="header-anchor">#</a> 组合函数</h3> <p>组合函数在<code>JavaScript</code>开发过程中一种对函数的使用技巧、模式，假使你现在要处理一项业务，需要调用到两个函数，而这两个函数是依次调用的，那么我们可以将这个函数组合起来（这个过程就是组合函数（<code>compose function</code>））</p> <p>举个例子，下面有<code>double</code>和<code>square</code>函数，我们业务场景是先调用<code>double</code>再将<code>double</code>函数返回的数据传递给square函数处理，我们可以使用组合函数方式组合以上两个函数</p> <p><strong>普通使用</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> num<span class="token operator">*</span><span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> num<span class="token operator">**</span><span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> count<span class="token operator">=</span><span class="token number">10</span>
<span class="token keyword">var</span> res<span class="token operator">=</span><span class="token function">square</span><span class="token punctuation">(</span><span class="token function">double</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 400</span>
</code></pre></div><p><strong>组合函数的使用</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> num<span class="token operator">*</span><span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> num<span class="token operator">**</span><span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">composeFn</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span>n</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">count</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">n</span><span class="token punctuation">(</span><span class="token function">m</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> newFn<span class="token operator">=</span><span class="token function">composeFn</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span>square<span class="token punctuation">)</span>
<span class="token keyword">var</span> res2<span class="token operator">=</span><span class="token function">newFn</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 400</span>
</code></pre></div><h4 id="实现组合函数"><a href="#实现组合函数" class="header-anchor">#</a> 实现组合函数</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">MyCompose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>fns</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length <span class="token operator">=</span> fns<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token comment">// 判断传入的参数是否为函数</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">&quot;Expected arguments are functions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 返回一个接收参数的函数</span>
  <span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 当前执行函数索引</span>
    <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// 调用当前索引对应的函数</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> length <span class="token operator">?</span> fns<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">:</span> args<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">++</span>index <span class="token operator">&lt;</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 将上一次返回的结果，传入到下一个函数中</span>
      <span class="token keyword">var</span> result <span class="token operator">=</span> fns<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> compose<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 调用通用组合函数</span>

<span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">MyCompose</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span> square<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="结合律"><a href="#结合律" class="header-anchor">#</a> 结合律</h4> <p>结合律 （英文为 <code>associativity</code>），函数的组合要满足结合律，例如<code>a</code>、<code>b</code>、<code>c</code>三个函数进行组合，可以将<code>a</code>和<code>b</code>进行组合，或者是<code>b</code>和<code>c</code>进行组合。这个特性计算结合律。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> ass1 <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token function">compose</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> ass2 <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>composea<span class="token punctuation">,</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="pointfree"><a href="#pointfree" class="header-anchor">#</a> pointfree</h4> <p><code>pointfree</code>是一种编程风格，这种风格也被称之为<code>Tacit programming</code>，<code>point</code>代表形参，意思是没有形参的编程风格。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// pointfree风格，带有word形参</span>
<span class="token keyword">var</span> <span class="token function-variable function">word</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> word<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// pointfree风格，没有任何形参</span>
<span class="token keyword">var</span> word <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>toUpperCase<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>也就是说，我们完全可以把数据处理的过程，定义成一种与参数无关的合成运算。不需要用到代表数据的那个参数，只要把一些简单的运算步骤合成在一起即可。</p> <p>它省去了对参数命名的麻烦，代码也更加简洁优雅。<code>pointfree</code>是基础函数的组合的高级函数，这些高级函数往往应用在我们的业务中。</p> <h4 id="debug"><a href="#debug" class="header-anchor">#</a> Debug</h4> <p>从上面的知识中，我们知道组合函数是多个函数的组合，当组合函数返回的结果与预期不符合时，如何去调试它？</p> <ul><li>对中间的值进行打印，并且知道当前执行位置</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> log <span class="token operator">=</span> <span class="token function">MyCurrying</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">t<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> v<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>在组合函数中，按照从左往右的顺序，给个函数套上log函数，就可以知道每次输出的值</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> newFn <span class="token operator">=</span> <span class="token function">MyCompose</span><span class="token punctuation">(</span>double<span class="token punctuation">,</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'double--'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>square<span class="token punctuation">,</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'double--'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> res2 <span class="token operator">=</span> <span class="token function">newFn</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// double-- 20</span>
<span class="token comment">// double-- 400</span>
<span class="token comment">// 400</span>
</code></pre></div><h3 id="with语句"><a href="#with语句" class="header-anchor">#</a> with语句</h3> <h3 id="eval语句"><a href="#eval语句" class="header-anchor">#</a> eval语句</h3> <p>eval是一个特殊的函数，它可以将传入的字符串当JavaScript代码来运行</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'1+1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
</code></pre></div><ul><li>实际开发中不要使用eval
<ul><li>eval可读性很差</li> <li>eval是一个字符串，有被篡改的可能</li> <li>eval执行必须经过js解释器，不能被js引擎优化</li></ul></li></ul> <h3 id="严格模式"><a href="#严格模式" class="header-anchor">#</a> 严格模式</h3> <ul><li>在ECMAScript5标准中，JavaScript提出了严格模式的概念（Strict Mode）
<ul><li>是一个有限制性的JavaScript模式，从而<strong>使代码隐式的脱离了懒散（sloppy）模式</strong></li> <li>支持严格模式的浏览器在<strong>检测代码中有严格模式时</strong>（开头 <code>use strict</code>），会以更加严格模式对代码进行检测和执行</li></ul></li> <li>严格模式对正常的JavaScript语义进行了一些限制
<ul><li>严格模式通过抛出错误来消除一些原有的静默错误（例如 123.name=‘island’，这不会造成严重的错误，所以不会报错，但严格模式下不能这样子写）</li> <li>严格模式让<strong>js引擎在执行代码时可以进行更多的优化</strong>（不需要对一些特殊的语法进行处理）</li> <li>严格模式禁用了<strong>在ECMAScript未来版本中可以会定义的一些语法</strong>（保留字class const let和关键字function var new）（保留字会升级成关键字）</li></ul></li></ul> <h4 id="如何开启严格模式"><a href="#如何开启严格模式" class="header-anchor">#</a> 如何开启严格模式</h4> <ul><li>在JS文件中开启严格模式
<ul><li>在文件开头写<code>use strict</code></li></ul></li> <li>在单个function开启严格模式
<ul><li>在函数的开头写<code>use strict</code></li></ul></li></ul> <h4 id="严格模式的限制"><a href="#严格模式的限制" class="header-anchor">#</a> 严格模式的限制</h4> <h3 id="面向对象"><a href="#面向对象" class="header-anchor">#</a> 面向对象</h3> <ul><li>面向对象是现实的抽象方式</li> <li>对象是JavaScript中一个非常重要的概念，这是因为对象可以将多个相关的数据封装到一起，更好的描述一个事务</li> <li>JavaScript支持多种编程范式，包括函数式编程和面向对象编程
<ul><li>对象是一组属性的无序集合，像是一个哈希表，有key和value组成</li> <li>key是标识符的名称，value可以是任意类型，也可以是对象或者函数</li> <li>如果值是函数，我们称为对象的方法</li></ul></li></ul> <h3 id="object-defineproperty"><a href="#object-defineproperty" class="header-anchor">#</a> Object.defineProperty</h3> <p>该方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象</p> <p>MDN：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty</p> <div class="language- extra-class"><pre class="language-text"><code>语法 Object.defineProperty(obj, prop, descriptor)
</code></pre></div><ul><li>obj 要定义属性的对象。</li> <li>prop 要定义或修改的属性的名称或 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol" target="_blank" rel="noopener noreferrer"><code>Symbol</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</li> <li>descriptor 要定义或修改的属性描述符。</li></ul> <h4 id="属性描述符"><a href="#属性描述符" class="header-anchor">#</a> 属性描述符</h4> <h4 id="数据属性描述符"><a href="#数据属性描述符" class="header-anchor">#</a> 数据属性描述符</h4> <ul><li>configurable表示属性是否通过delete删除属性，是否可以修改它的特性，或者是否可以将它修改为存取属性描述符
<ul><li>当我们直接在一个对象上定义某个属性时，这个属性的configurable为true</li> <li>当我们通过属性描述符定义一个属性时，这个属性的configurable默认为false</li></ul></li> <li>enumerable表示属性是否可以通过for-in 和 object.keys查看，返回该属性
<ul><li>当我们在一个对象上定义某个属性时，这个enumerable属性为true</li> <li>当我们通过属性描述符定义一个属性时，这个enumerable属性为false</li></ul></li> <li>writable表示是否可以修改属性的值
<ul><li>当我们在一个对象上定义某个属性时，这个writable属性为true</li> <li>当我们通过属性描述符定义一个属性时，这个writable属性为false</li></ul></li> <li>value属性的值，读取属性时会返回该值，修改属性时也会被修改
<ul><li>默认情况下为undefined</li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 通过字面量方式创建的对象，数据属性描述符默认都是true</span>
<span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'_island'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'address'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token comment">// 这个属性不能删除 // 不能重新定义属性描述符</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token string">'广州市'</span><span class="token punctuation">,</span>
  <span class="token comment">// 配置属性是否可以枚举</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span><span class="token boolean">false</span>

  <span class="token comment">// 如果以上属性不写，默认都是false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>address
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 广州市</span>
<span class="token comment">//   enumerable:false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: '_island', age: 18 }</span>
<span class="token comment">//   enumerable:true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: '_island', age: 18, address: '广州市' }</span>

obj<span class="token punctuation">.</span>address<span class="token operator">=</span><span class="token string">'潮汕'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// { name: '_island', age: 18, address: '广州市' }</span>
</code></pre></div><h4 id="定义多个属性描述符"><a href="#定义多个属性描述符" class="header-anchor">#</a> 定义多个属性描述符</h4> <p>可以<code>Object.defineProperties</code>属性定义多个属性描述符，每个属性以对象的形式进行定义。</p> <div class="language- extra-class"><pre class="language-text"><code>var obj = {
  // 私有属性
  _age: 18,
};

Object.defineProperties(obj, {
  name: {
    configurable: true,
    writable: true,
    enumerable: true,
    value: &quot;_island&quot;
  },
  age:{
    configurable:false,
    enumerable:false,
    get:()=&gt;{
      console.log('调用了ages get');
      return this._age
    },
    set:(val)=&gt;{
      console.log('调用了ages set');
      this._age=val
    }
  }
});
// 除了上面的写法，也可以这样子写，但会有一点差异，比如可枚举
var obj = {
  // 私有属性
  _age: 18,
  // 也可以这样子写
  set age(val) {
    this._age = val;
  },
  get age() {
    return this._age;
  }
};
</code></pre></div><h4 id="存取属性描述符"><a href="#存取属性描述符" class="header-anchor">#</a> 存取属性描述符</h4> <ul><li>configurable表示属性是否通过delete删除属性，是否可以修改它的特性，或者是否可以将它修改为存取属性描述符
<ul><li>当我们直接在一个对象上定义某个属性时，这个属性的configurable为true</li> <li>当我们通过属性描述符定义一个属性时，这个属性的configurable默认为false</li></ul></li> <li>enumerable表示属性是否可以通过for-in 和 object.keys查看，返回该属性
<ul><li>当我们在一个对象上定义某个属性时，这个enumerable属性为true</li> <li>当我们通过属性描述符定义一个属性时，这个enumerable属性为false</li></ul></li> <li>get
<ul><li>获取属性时会执行的函数，默认为undefined</li></ul></li> <li>set
<ul><li>设置属性时会执行的函数，默认为undefined</li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'_island'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token literal-property property">_address</span><span class="token operator">:</span><span class="token string">'广州市'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 隐藏某个私有属性</span>
<span class="token comment">// 截获某个属性的访问和设置的过程，也会使用存取属性描述符</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'address'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_address
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_address<span class="token operator">=</span>val
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>address<span class="token operator">=</span><span class="token string">'潮汕'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'获取了address的值'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="获取属性描述符"><a href="#获取属性描述符" class="header-anchor">#</a> 获取属性描述符</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 私有属性</span>
  <span class="token literal-property property">_age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'调用了ages get'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_age
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'调用了ages set'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_age<span class="token operator">=</span>val
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 获取属性描述符</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {</span>
<span class="token comment">//   value: '_island',</span>
<span class="token comment">//   writable: true,</span>
<span class="token comment">//   enumerable: true,</span>
<span class="token comment">//   configurable: true</span>
<span class="token comment">// }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {</span>
<span class="token comment">//   get: [Function: get],</span>
<span class="token comment">//   set: [Function: set],</span>
<span class="token comment">//   enumerable: false,</span>
<span class="token comment">//   configurable: false</span>
<span class="token comment">// }</span>

<span class="token comment">// 获取对象所有描述符</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {</span>
<span class="token comment">//   _age: { value: 18, writable: true, enumerable: true, configurable: true }, </span>
<span class="token comment">//   name: {</span>
<span class="token comment">//     value: '_island',</span>
<span class="token comment">//     writable: true,</span>
<span class="token comment">//     enumerable: true,</span>
<span class="token comment">//     configurable: true</span>
<span class="token comment">//   },</span>
<span class="token comment">//   age: {</span>
<span class="token comment">//     get: [Function: get],</span>
<span class="token comment">//     set: [Function: set],</span>
<span class="token comment">//     enumerable: false,</span>
<span class="token comment">//     configurable: false</span>
<span class="token comment">//   }</span>
<span class="token comment">// }</span>
</code></pre></div><h4 id="额外的object方法"><a href="#额外的object方法" class="header-anchor">#</a> 额外的Object方法</h4> <ul><li><code>Object.preventExtensions()</code>方法让一个对象变的不可扩展，也就是永远不能再添加新的属性。</li> <li><code>Object.seal()</code>方法封闭一个对象，阻止添加新属性并将所有现有属性标记为不可配置。当前属性的值只要原来是可写的就可以改变。</li> <li><code>Object.freeze()</code> 方法可以<strong>冻结</strong>一个对象。一个被冻结的对象再也不能被修改</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'_island'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>

<span class="token comment">// 禁止对象添加新的属性</span>
Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>address<span class="token operator">=</span><span class="token string">'广州市'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: '_island', age: 18 }</span>

<span class="token comment">// 方法二</span>
Object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token keyword">delete</span> obj<span class="token punctuation">.</span>name
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>

<span class="token comment">// 让属性不能进行修改操作</span>
Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'abc'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>
</code></pre></div><h3 id="工厂模式"><a href="#工厂模式" class="header-anchor">#</a> 工厂模式</h3> <p>是一种常见的设计模式，通过该工厂方法产生想要的对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> height<span class="token punctuation">,</span> address</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>address <span class="token operator">=</span> address<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>
  p<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot;在吃东西&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  p<span class="token punctuation">.</span><span class="token function-variable function">running</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot;在跑步&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1.88</span><span class="token punctuation">,</span> <span class="token string">&quot;广州市&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">1.58</span><span class="token punctuation">,</span> <span class="token string">&quot;北京市&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;王五&quot;</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">1.66</span><span class="token punctuation">,</span> <span class="token string">&quot;上海市&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 工厂模式的缺点</span>
<span class="token comment">// 获取不到对象最真实的类型</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="构造函数"><a href="#构造函数" class="header-anchor">#</a> 构造函数</h3> <ul><li>别名为构造器constructor，是一种特殊的方法，用来初始化对象时会调用的函数</li> <li>在JavaScript中的构造函数有点不太一样</li> <li>构造函数的首字母一般是大写</li></ul> <h4 id="通过new调用函数"><a href="#通过new调用函数" class="header-anchor">#</a> 通过new调用函数</h4> <ol><li>在内存中创建一个新的对象（空对象）</li> <li>这个对象内部的prototype属性会被赋值为该构造函数的prototype属性</li> <li>构造函数内部的this会指向创建出来的新对象</li> <li>执行函数的内部代码（函数体代码）</li> <li>如果构造函数没有返回非空对象，则返回创建出来的新对象</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment">// foo是一个普通的函数</span>

<span class="token comment">// 换一种方式来调用foo函数</span>
<span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 通过new去调用函数和通过普通方式调用函数有什么区别</span>
</code></pre></div><h4 id="使用new去创建一个新的对象"><a href="#使用new去创建一个新的对象" class="header-anchor">#</a> 使用new去创建一个新的对象</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 规范 构造函数的首字母一般是大写</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>height<span class="token punctuation">,</span>address</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token operator">=</span>height
  <span class="token keyword">this</span><span class="token punctuation">.</span>address<span class="token operator">=</span>address
  
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">eating</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在吃东西'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">running</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在跑步'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1.88</span><span class="token punctuation">,</span><span class="token string">'广州市'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1.78</span><span class="token punctuation">,</span><span class="token string">'广州市'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>eating<span class="token operator">===</span>p2<span class="token punctuation">.</span>eating<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>running<span class="token operator">===</span>p2<span class="token punctuation">.</span>running<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="原型"><a href="#原型" class="header-anchor">#</a> 原型</h4> <ul><li><p>每个对象都有原型 (隐式原型)</p></li> <li><p>JavaScript当中每个对象都有一个特殊的内置属性prototype(原型),这个特殊的对象可以指向另外一个对象</p></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'_island'</span>
  <span class="token comment">// 这里面隐藏了prototype</span>
<span class="token punctuation">}</span>

<span class="token comment">// 空对象也是有prototype</span>
 <span class="token keyword">var</span> info <span class="token operator">=</span><span class="token punctuation">{</span> 
<span class="token comment">// [[prototype]]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>浏览器为了给开发者可以去查看这个属性,给对象中提供了一个属性,可以让我们查看这个原型对象(浏览器提供)</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// __proto__</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ECMA5之后,提供了一个方法来获取这个原型</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="原型的作用"><a href="#原型的作用" class="header-anchor">#</a> 原型的作用</h4> <p>当我们从一个对象中获取一个属性,它会触发到[[get]]操作
1.在当前对象中，去查找对应的属性，如果找到了就直接用
2.如果没有查找，就会沿着原型链去查找[[prototype ]]</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>obj<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">18</span>
obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">20</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="函数的原型"><a href="#函数的原型" class="header-anchor">#</a> 函数的原型</h4> <p>在JavaScript中，函数也是一个对象，也有prototype隐式原型</p> <p>由于它是函数，它还会多出一个显示原型prototype属性也是指向<code>__proto__</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 与__proto__一样</span>

<span class="token keyword">var</span> f1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> f2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>__proto__<span class="token operator">===</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f2<span class="token punctuation">.</span>__proto__<span class="token operator">===</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="函数原型上的属性"><a href="#函数原型上的属性" class="header-anchor">#</a> 函数原型上的属性</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {</span>
<span class="token comment">//   constructor: {</span>
<span class="token comment">//     value: [Function: foo],</span>
<span class="token comment">//     writable: true,</span>
<span class="token comment">//     enumerable: false, // 不可枚举</span>
<span class="token comment">//     configurable: true</span>
<span class="token comment">//   }</span>
<span class="token comment">// }</span>

</code></pre></div><p>直接在原型上添加name属性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'_island'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> f1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//_island</span>
</code></pre></div><p>假使，需要在prototype属性上添加很多的属性，可以直接修改整个prototype对象</p> <blockquote><p>直接赋值会让prototype属性中的constructor方法消失</p></blockquote> <p>添加constructor属性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>foo<span class="token punctuation">.</span>prototype<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">constructor</span><span class="token operator">:</span>foo<span class="token punctuation">,</span> <span class="token comment">// 但这样子添加的话enumerable（可枚举）是true</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'_island'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 真实开发中我们可以通过object.defineProperty方式添加constructor</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'constructor'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span>foo
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="原型和构造函数创建对象"><a href="#原型和构造函数创建对象" class="header-anchor">#</a> 原型和构造函数创建对象</h4> <p>在之前，我们创建对象，每个对象都是一个独立的内存空间，这样会出现一个问题也就是方法都是相同的。它们没有必要重新开辟一块新的空间</p> <p><strong>使用原型来给构造函数添加方法</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>height<span class="token punctuation">,</span>address</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// Person.prototype.name=name</span>
    <span class="token comment">// Person.prototype.age=age</span>
    <span class="token comment">// Person.prototype.height=height</span>
    <span class="token comment">// Person.prototype.address=address</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token operator">=</span>age
    <span class="token keyword">this</span><span class="token punctuation">.</span>height<span class="token operator">=</span>height
    <span class="token keyword">this</span><span class="token punctuation">.</span>address<span class="token operator">=</span>address
    <span class="token comment">// 如果是方法时，可以写上原型上</span>
    <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">running</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">+</span><span class="token string">'在跑步'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'_island'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1.8</span><span class="token punctuation">,</span><span class="token string">'广州市'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">1.7</span><span class="token punctuation">,</span><span class="token string">'广州市'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="面向对象-2"><a href="#面向对象-2" class="header-anchor">#</a> 面向对象</h3> <ul><li>面向对象有三大特性
<ul><li>封装，把属性和方法封装到一个类中</li> <li>继承，面向对象中非常重要的，可以减少重复代码数量，也是多态前提（纯面向对象中）</li> <li>多态，不同对象在执行时表现出不同的形态</li></ul></li></ul> <h3 id="javascript原型链"><a href="#javascript原型链" class="header-anchor">#</a> JavaScript原型链</h3> <p>当我们从一个对象上获取一个属性，它会触发到[[get]]操作</p> <ul><li>先从这个对象中查找这个属性</li> <li>如果这个对象中没有这个属性，会从这个对象中的<code>__proto__</code>原型中进行查找</li> <li>原型上还会有原型</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>obj<span class="token punctuation">.</span>__proto__<span class="token operator">=</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token operator">=</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'abc'</span>
<span class="token punctuation">}</span>

<span class="token comment">// abc</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="原型链的尽头"><a href="#原型链的尽头" class="header-anchor">#</a> 原型链的尽头</h3> <p>其实在<code>obj</code>的原型就是我们最顶层的原型</p> <p>从<code>object</code>创建出来的对象的原型都是<code>[object null prototype]{}</code></p> <h4 id="关于-object-null-prototype"><a href="#关于-object-null-prototype" class="header-anchor">#</a> 关于<code>[object null prototype]{}</code></h4> <ul><li>该对象有原型属性，它已经指向null了（最顶层原型）</li> <li>该对象上有很多默认的属性和方法</li></ul> <p>顶层来自<code>Object.prototype</code>对象</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>obj<span class="token punctuation">.</span>__proto__<span class="token operator">===</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
</code></pre></div><h3 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h3> <h4 id="继承的作用"><a href="#继承的作用" class="header-anchor">#</a> 继承的作用</h4> <p>在没有继承的时候，我们的代码是下面这样子的，会有很多的冗余代码。</p> <div class="language- extra-class"><pre class="language-text"><code>function Student(name,age,sno){
  this.name=name
  this.age=age
  this.sno=sno
}

Student.prototype.running=function(){
  console.log(this.name+'在跑步');
}
Student.prototype.eating=function(){
  console.log(this.name+'在吃饭');
}
Student.prototype.studying=function(){
  console.log(this.name+'在学习');
}

// teacher
function Teacher(name,age,title){
  this.name=name
  this.age=age
  this.sno=sno
}

Teacher.prototype.running=function(){
  console.log(this.name+'在跑步');
}
Teacher.prototype.eating=function(){
  console.log(this.name+'在吃饭');
}
Teacher.prototype.studying=function(){
  console.log(this.name+'在学习');
}
</code></pre></div><h4 id="借用构造函数"><a href="#借用构造函数" class="header-anchor">#</a> 借用构造函数</h4> <h4 id="父类原型给子类使用"><a href="#父类原型给子类使用" class="header-anchor">#</a> 父类原型给子类使用</h4> <h4 id="原生式继承"><a href="#原生式继承" class="header-anchor">#</a> 原生式继承</h4> <h4 id="寄生式继承"><a href="#寄生式继承" class="header-anchor">#</a> 寄生式继承</h4> <ul><li>寄生式继承是与原型式继承紧密相关的一种思想，并且同样由道格拉斯 克罗克福德提出和推广的</li> <li>寄生式继承的思路是结合原型类继承和工厂模式的一种方式</li> <li>即创建一个封装继承过程的函数，该函数在内部以某种方式来增强对象，最后再将这个对象返回</li></ul> <h3 id="es6"><a href="#es6" class="header-anchor">#</a> ES6</h3> <blockquote><p>又称，es2015，ecma2015</p></blockquote> <ul><li>按照前面的构造函数方式创建的类，不仅仅和编写普通函数过于类似，而且代码并不容易理解
<ul><li>在es6新的标准中使用了class关键字来直接定义类</li> <li>但是类本质上依然是前面所讲的构造函数，原型链的语法糖而已</li> <li>所以学好了前面的构造函数，原型链更有利我们理解类的概念和继承关系</li></ul></li> <li>定义类的方式
<ul><li>声明类  <code>class</code></li> <li>类表达式 <code>var foo = class {}</code></li></ul></li></ul> <p>在<code>ES6</code>（<code>ECMAScript6</code>）之前，<code>JavaScript</code>语法中是不支持类的，导致面向对象编程方法无法直接使用，但我们可以通过function来实现模拟出类，而随着<code>JavaScript</code>的更新，在<code>ES6</code>出现了中出现<code>class</code>关键字，可以用于定义类。接下来让我们看看它的如何使用的。</p> <h3 id="class"><a href="#class" class="header-anchor">#</a> class</h3> <p>下面我们来看看如何使用<code>class</code>关键字声明一个类。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment">// or</span>

<span class="token keyword">const</span> Animal <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>而在<code>ES6</code>之前，我们都是通过以下这样子的方式来模拟出类的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="类的构造函数"><a href="#类的构造函数" class="header-anchor">#</a> 类的构造函数</h3> <p>每一个类都可以有一个自己的构造函数，这个名称是固定的<code>constructor</code>，当我们通过<code>new</code>调用一个类时，这个类就会调用自己的<code>constructor</code>方法（构造函数）。</p> <ul><li>它用于创建对象时给类传递一些参数</li> <li>每一个类只能有一个构造函数，否则报错</li></ul> <p>通过<code>new</code>调用一个类时，会调用构造函数，执行如下操作过程：</p> <ol><li>在内存中开辟一块新的空间用于创建新的对象</li> <li>这个对象内部的<code>prototype</code>属性会被赋值为该类的<code>prototype</code>属性</li> <li>构造函数内的this，指向创建出来的新对象</li> <li>执行构造函数的内部代码</li> <li>如果函数没有返回对象，则返回<code>this</code></li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span>  <span class="token punctuation">{</span>
  <span class="token comment">// 类的构造方法</span>
  <span class="token comment">// 用于接收函数</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">&quot;ABC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Animal { name: 'ABC' }</span>
</code></pre></div><p>上面这个例子中，我们在<code>class</code>中定义的<code>constructor</code>，这个就是构造方法，而<code>this</code>代表的是实例对象。</p> <p>这个<code>class</code>，你可以把它看作构造函数的另外一种写法，因为它和它的构造函数的相等的，即是类本身指向构造函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Animal <span class="token operator">===</span> <span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>其实，在类上的所有方法都会放在<code>prototype</code>属性上。</p> <h3 id="类中的属性"><a href="#类中的属性" class="header-anchor">#</a> 类中的属性</h3> <h4 id="实例属性"><a href="#实例属性" class="header-anchor">#</a> 实例属性</h4> <p>实例的属性必须定义在类的方法里，就如上面的例子，我们在构造函数中定义<code>name</code>这个属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>height<span class="token punctuation">,</span>weight</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height
    <span class="token keyword">this</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> weight
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="静态属性"><a href="#静态属性" class="header-anchor">#</a> 静态属性</h4> <p>当我们把一个属性赋值给类本身，而不是赋值给它<code>prototype</code>，这样子的属性被称之为静态属性（<code>static</code>）。</p> <p>静态属性直接通过类来访问，无需在实例中访问。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> name <span class="token operator">=</span><span class="token string">'_island'</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="私有属性"><a href="#私有属性" class="header-anchor">#</a> 私有属性</h4> <p>私有属性只能在类中读取、写入，不能通过外部引用私有字段。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
  #age<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>name
    <span class="token keyword">this</span><span class="token punctuation">.</span>#age<span class="token operator">=</span>age
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token string">'_island'</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Animal { name: '_island' }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>#age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Private field '#age' must be declared in an enclosing class</span>
</code></pre></div><p>我们通过<code>getOwnPropertyDescriptors</code>方法获取到它的属性，同样也是获取不到。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></span><span class="token punctuation">)</span>

<span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'_island'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>私有字段仅能在字段声明中预先定义。</p></blockquote> <blockquote><p>公共和私有字段声明是JavaScript标准委员会<a href="https://tc39.es/" target="_blank" rel="noopener noreferrer">TC39<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>提出的<a href="https://github.com/tc39/proposal-class-fields" target="_blank" rel="noopener noreferrer">实验性功能（第3阶段）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。浏览器中的支持是有限的，但是可以通过<a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer">Babel<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等系统构建后使用此功能。</p></blockquote> <h3 id="类中的方法"><a href="#类中的方法" class="header-anchor">#</a> 类中的方法</h3> <h4 id="实例方法"><a href="#实例方法" class="header-anchor">#</a> 实例方法</h4> <p>在<code>ES6</code>之前，我们定义类中的方法是类中的原型上进行定义的，防止类中的方法重复在多个对象上。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eating</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; eating&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>在<code>ES6</code>中，定义类中的方法更加简洁，直接在类中定义即可，这样子的写法即优雅可读性也强。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
  <span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; eating&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="静态方法"><a href="#静态方法" class="header-anchor">#</a> 静态方法</h4> <p>静态方法与上面提到的静态属性是一样的，在方法前面使用<code>static</code>关键字进行声明，之后调用这个方法时不需要通过类的实例来调用，可以直接通过类名来调用它。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> name
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a2 <span class="token operator">=</span> Animal<span class="token punctuation">.</span><span class="token function">createName</span><span class="token punctuation">(</span><span class="token string">&quot;_island&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>
</code></pre></div><h4 id="私有方法"><a href="#私有方法" class="header-anchor">#</a> 私有方法</h4> <p>在面向对象中，私有方法是一个常见需求，但是在ES6中没有提供，我们可以通过某个方法来实现它。</p> <div class="language- extra-class"><pre class="language-text"><code>class Foo {
  __getBloodType() {
    return &quot;O&quot;;
  }
}

</code></pre></div><blockquote><p>需要注意的是，通过下划线开头通常我们会局限它是一个私有方法，但是在类的外部还是可以正常调用到这个方法的</p></blockquote> <h3 id="类的继承"><a href="#类的继承" class="header-anchor">#</a> 类的继承</h3> <p><code>extends</code>关键字用于扩展子类，创建一个类作为另外一个类的一个子类。</p> <p>它会将父类中的属性和方法一起继承到子类的，减少子类中重复的业务代码。</p> <p>这对比之前在<code>ES5</code>中修改原型链实现继承的方法的可读性要强很多，而且写法很简洁。</p> <h4 id="extends的使用"><a href="#extends的使用" class="header-anchor">#</a> extends的使用</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token comment">// dog 继承 Animal 类</span>
<span class="token keyword">class</span> <span class="token class-name">dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="继承类的属性和方法"><a href="#继承类的属性和方法" class="header-anchor">#</a> 继承类的属性和方法</h4> <p>下面这个例子，我们定义了<code>dog</code>这个类，通过<code>extends</code>关键字继承了<code>Animal</code>类的属性和方法。</p> <p>在子类的<code>constructor</code>方法中，我们使用了<code>super</code>关键字，在子类中它是必须存在的，否则新建实例时会抛出异常。这是因为子类的this对象是继承自父类的this对象，如果不调用<code>super</code>方法，子类就得不到<code>this</code>对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; eating&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// dog 继承 Animal 类</span>
<span class="token keyword">class</span> <span class="token class-name">dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> legs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>legs <span class="token operator">=</span> legs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">speaking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; speaking&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dog</span><span class="token punctuation">(</span><span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// tom eating</span>
d<span class="token punctuation">.</span><span class="token function">speaking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// tom speaking</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// tom</span>
</code></pre></div><h4 id="super"><a href="#super" class="header-anchor">#</a> Super</h4> <p><strong>super</strong>关键字用于访问和调用一个对象的父对象上的函数。</p> <p><code>super</code>指的是超级、顶级、父类的意思</p> <p>在子类的构造函数中使用<code>this</code>或者返回默认对象之前，必须先通过<code>super</code>调用父类的构造函数。</p> <p>下面这段代码，子类的<code>constructor</code>方法中先调用了<code>super</code>方法，它代表了父类的构造函数，也就是说我们把参数传递进去之后，其实它是调用了父类的构造函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">dog</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>type<span class="token punctuation">,</span>weight</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token operator">=</span>type
    <span class="token keyword">this</span><span class="token punctuation">.</span>weight<span class="token operator">=</span>weight
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面这段代码使用super调用父类的方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; eating&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// dog 继承 Animal 类</span>
<span class="token keyword">class</span> <span class="token class-name">dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> legs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>legs <span class="token operator">=</span> legs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">speaking</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">eating</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; speaking&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span>

<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dog</span><span class="token punctuation">(</span><span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span><span class="token function">speaking</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// tom eating tom speaking</span>
</code></pre></div><h3 id="getter-和-setter"><a href="#getter-和-setter" class="header-anchor">#</a> Getter 和 Setter</h3> <p>在类内部也可以使用<code>get</code>和<code>set</code>关键字，对应某个属性设置存值和取值函数，拦截属性的存取行为。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">age</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">age</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_age <span class="token operator">=</span> val<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
a<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//4</span>
</code></pre></div><h3 id="关于class扩展"><a href="#关于class扩展" class="header-anchor">#</a> 关于class扩展</h3> <h4 id="严格模式-2"><a href="#严格模式-2" class="header-anchor">#</a> 严格模式</h4> <p>在类和模块的内部，默认是严格模式，所以不需要使用<code>use strict</code>指定运行模式。只要你的代码写在类或模块之中，就只有严格模式可用。</p> <h4 id="name属性"><a href="#name属性" class="header-anchor">#</a> name属性</h4> <p><code>ES6</code>中的类只是<code>ES5</code>构造函数的一层包装，所以函数的许多属性都被<code>class</code>继承了，包括<code>name</code>属性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Animal<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Animal</span>
</code></pre></div><h4 id="变量提升"><a href="#变量提升" class="header-anchor">#</a> 变量提升</h4> <p><code>class</code>不存在变量提升，这与我们在<code>ES5</code>中实现类的不同的，<code>function</code>关键字会存在变量提升。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>在<code>ES6</code>之后，我们在定义类以及它内部的属性方法，还有继承操作的语法变得非常简洁且易懂，<code>class</code>是一个语法糖，其内部还是通过<code>ES5</code>中的语法来实现的。且有些浏览器不支持<code>class</code>语法，我们可以通过<code>babel</code>来进行转换。</p> <h3 id="es6知识点"><a href="#es6知识点" class="header-anchor">#</a> ES6知识点</h3> <h3 id="什么是es6"><a href="#什么是es6" class="header-anchor">#</a> 什么是ES6</h3> <p><code>ES6</code>是<code>ECMAScript 6.0</code>是简称，其实它在2015年6月就发布出来了，所以又称<code>ES2015</code>，目的是使<code>JavaScript</code>这一门语言可以来编写更加复杂的大型应用。</p> <h3 id="let-和-const"><a href="#let-和-const" class="header-anchor">#</a> let 和 const</h3> <p><code>ES6</code>中新增了<code>let</code>和<code>const</code>用于声明变量、常量。我们知道通过<code>var</code>关键字声明的变量都会在<code>window</code>对象上。而使用<code>let</code>和<code>const</code>关键字声明的变量、常量只局限在当前作用域内使用，且没有作用域提升。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="数据解构"><a href="#数据解构" class="header-anchor">#</a> 数据解构</h3> <p>一个从数组或者对象中方便获取数据的方法（<code>Destructuring</code>）。</p> <p>数组中的解构有基本解构过程、顺序解构、解构出数组、默认值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>item1<span class="token punctuation">,</span> item2<span class="token punctuation">,</span> item3<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item1<span class="token punctuation">,</span> item2<span class="token punctuation">,</span> item3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10 20 30</span>
</code></pre></div><p>对象中的解构有基本解构过程、任意顺序、重命名、默认值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span> <span class="token operator">=</span> obj<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18</span>
</code></pre></div><h3 id="字符串模板"><a href="#字符串模板" class="header-anchor">#</a> 字符串模板</h3> <p>在<code>ES6</code>中我们可以在字符串中使用变量和表达式。使得字符串和变量之间拼接起来的语法更加优雅。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> city <span class="token operator">=</span><span class="token string">'Guangzhou'</span>

<span class="token comment">// ES5中</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I live in '</span><span class="token operator">+</span>city<span class="token punctuation">)</span> <span class="token comment">// I live in Guangzhou</span>
<span class="token comment">// ES6中</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">I live in </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>city<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token comment">// I live in Guangzhou</span>
</code></pre></div><h3 id="函数的默认参数"><a href="#函数的默认参数" class="header-anchor">#</a> 函数的默认参数</h3> <p>在<code>ES6</code>中，我们可以给函数的参数定义一个默认值，当这个参数没有被传入时则使用这个默认参数。</p> <p>我们先看看看在<code>ES5</code>中如何实现的函数默认值</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">var</span> name<span class="token operator">=</span>name <span class="token operator">||</span> <span class="token string">'_island'</span>
<span class="token keyword">var</span> age<span class="token operator">=</span>age <span class="token operator">||</span> <span class="token number">18</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'name is '</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'age is '</span><span class="token operator">+</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// name is _island  age is 18</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token comment">// name is abc  age is 17</span>
</code></pre></div><p>而在<code>ES6</code>之后，我们直接在函数形参后面定义一个默认值即可，我们稍微修改下上面的例子。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'_island'</span><span class="token punctuation">,</span>age<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'name is '</span><span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'age is '</span><span class="token operator">+</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// name is _island  age is 18</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token comment">// name is abc  age is 17</span>
</code></pre></div><h3 id="函数剩余参数"><a href="#函数剩余参数" class="header-anchor">#</a> 函数剩余参数</h3> <p><code>ES6</code>中引用了<code>rest parameter</code>，可以将不定数量的参数放到一个数组中。在函数最后的一个参数放入<code>...args</code>，在函数体中<code>args</code>是一个数组。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'---args'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
<span class="token comment">// 1 2 3</span>
<span class="token comment">// ---args</span>
<span class="token comment">// [</span>
<span class="token comment">//   4, 5,  6, 7,</span>
<span class="token comment">//   8, 9, 10</span>
<span class="token comment">// ]</span>

</code></pre></div><ul><li>与<code>arguments</code>区别
<ul><li>剩余次数只包含没有对应实参，而<code>arguments</code>对象包含了传给函数的所有实参</li> <li><code>rest</code>参数是一个数组，而<code>argument</code>对象是伪数组</li> <li>剩余参数必须放在最后面</li></ul></li></ul> <h3 id="箭头函数"><a href="#箭头函数" class="header-anchor">#</a> 箭头函数</h3> <p>在<code>ES6</code>中新增箭头函数，因为它的定义用的就箭头。我们看看它的用法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ES5</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// ES6</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>当有参数和函数体时，箭头函数是这样子声明的</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// ES5</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ES6</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="箭头函数的简写"><a href="#箭头函数的简写" class="header-anchor">#</a> 箭头函数的简写</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 函数体里只有一条函数时可以这样子写，并默认将这条语句返回(省略return)</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 当只有一个参数时,()可以省略掉 ,多个参数不能省略</span>
<span class="token keyword">const</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token parameter">name</span><span class="token operator">=&gt;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="箭头函数注意事项"><a href="#箭头函数注意事项" class="header-anchor">#</a> 箭头函数注意事项</h4> <ul><li>箭头函数不能作为构造函数使用</li> <li>箭头函数没有原型</li> <li>箭头函数内没有<code>arguments</code></li> <li>箭头函数不能使用<code>yield</code>关键字</li></ul> <h4 id="关于箭头函数的指向问题"><a href="#关于箭头函数的指向问题" class="header-anchor">#</a> 关于箭头函数的指向问题</h4> <ul><li>箭头函数没有<code>this</code>，它的<code>this</code>是它的父级</li> <li><code>this</code>是在定义箭头函数时绑定的</li></ul> <h4 id="class关键字"><a href="#class关键字" class="header-anchor">#</a> Class关键字</h4> <p>关于<code>class</code>关键字，我在另外一篇文章中有详细介绍Class的用法和相关扩展知识点。</p> <blockquote><p><a href="https://juejin.cn/post/7058477703262896159" target="_blank" rel="noopener noreferrer">点击直达 JS进阶 | 详解ES6中的Class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="数值的表示"><a href="#数值的表示" class="header-anchor">#</a> 数值的表示</h3> <p>在<code>ES6</code>中支持了进制的字面量，需要在数字前面添加对应的标识符号。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> num1 <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// 十进制</span>
<span class="token keyword">const</span> num2 <span class="token operator">=</span> <span class="token number">0b100</span><span class="token punctuation">;</span> <span class="token comment">// 二进制</span>
<span class="token keyword">const</span> num3 <span class="token operator">=</span> <span class="token number">00100</span><span class="token punctuation">;</span> <span class="token comment">// 八进制</span>
<span class="token keyword">const</span> num4 <span class="token operator">=</span> <span class="token number">0x100</span><span class="token punctuation">;</span> <span class="token comment">// 十六进制</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num3<span class="token punctuation">,</span> num4<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100 4 64 256</span>
</code></pre></div><h3 id="字符串方法"><a href="#字符串方法" class="header-anchor">#</a> 字符串方法</h3> <p><code>ES6</code>中字符串对象的新增方法（常用方法）</p> <table><thead><tr><th>方法</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td><code>includes</code></td> <td>布尔值</td> <td>判断字符串中是否有子串</td></tr> <tr><td><code>startsWith</code></td> <td>布尔值</td> <td>判断字符串是否以指定字符开头</td></tr> <tr><td><code>endsWith</code></td> <td>布尔值</td> <td>判断字符串是否以指定字符结尾</td></tr> <tr><td><code>padStart</code></td> <td>补全之后的字符串</td> <td>补全字符串：开头补全</td></tr> <tr><td><code>padEnd</code></td> <td>补全之后的字符串</td> <td>补全字符串：尾部补全</td></tr> <tr><td><code>trimStart</code></td> <td>返回消除之后的字符串</td> <td>消除字符串开头的空格</td></tr> <tr><td><code>trimEnd</code></td> <td>返回消除之后的字符串</td> <td>消除字符串尾部的空格</td></tr></tbody></table> <h4 id="includes"><a href="#includes" class="header-anchor">#</a> includes</h4> <p><code>includes</code>方法用于判断字符串中是否有子串，返回布尔值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> str2 <span class="token operator">=</span> <span class="token string">&quot;hello world hello world&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 判断字符串中是否包含子串</span>
<span class="token keyword">const</span> s1 <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="startswith"><a href="#startswith" class="header-anchor">#</a> startsWith</h4> <p><code>startsWith</code>方法用于判断字符串是否以指定字符开头。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 判断字符串开头是否为h</span>
<span class="token keyword">const</span> ish <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;h&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ish<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="endswith"><a href="#endswith" class="header-anchor">#</a> endsWith</h4> <p><code>endsWith</code>方法用于判断字符串是否以指定字符结尾。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 判断字符串结尾是否为d</span>
<span class="token keyword">const</span> isd <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="padstart"><a href="#padstart" class="header-anchor">#</a> padStart</h4> <p><code>padStart</code>方法用于从起始开始补全字符串。返回补全之后的字符串，不会修改原字符串。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> str4 <span class="token operator">=</span> <span class="token string">&quot;100&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str4<span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 000100</span>
</code></pre></div><h4 id="padend"><a href="#padend" class="header-anchor">#</a> padEnd</h4> <p><code>endsWith</code>方法用于从尾部补全字符串。返回补全之后的字符串，不会修改原字符串。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> str5 <span class="token operator">=</span> <span class="token string">&quot;200&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str5<span class="token punctuation">.</span><span class="token function">padEnd</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">&quot;000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 200000</span>
</code></pre></div><blockquote><p><code>padStart</code> / <code>padEnd</code> 如果原字符串的长度，等于或大于最大长度，则字符串补全不生效，返回原字符串。</p></blockquote> <h4 id="trimstart"><a href="#trimstart" class="header-anchor">#</a> trimStart</h4> <p><code>trimStart</code>用于消除字符串开头的空格，返回消除之后的字符串，不会修改原字符串。</p> <h4 id="trimend"><a href="#trimend" class="header-anchor">#</a> trimEnd</h4> <p><code>trimStart</code>用于消除字符串尾部的空格，返回消除之后的字符串，不会修改原字符串。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> str6 <span class="token operator">=</span> <span class="token string">&quot;  _island  &quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str6<span class="token punctuation">.</span><span class="token function">trimStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '_island  '</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str6<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '  _island'</span>
</code></pre></div><h3 id="es6新增数据结构"><a href="#es6新增数据结构" class="header-anchor">#</a> ES6新增数据结构</h3> <h4 id="symbol"><a href="#symbol" class="header-anchor">#</a> Symbol</h4> <p><code>Symbol</code>是<code>ES6</code>中新增的一个基本数据类型之一，它是一个函数。每一个从<code>Symbol</code>函数返回的<code>Symbol</code>值都是独一无二的，<code>symbol</code>值作为对象属性的标识符，也是唯一的用途的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">===</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><h5 id="symbol作为key"><a href="#symbol作为key" class="header-anchor">#</a> symbol作为key</h5> <p>第一种方式，直接在对象的字面量中添加。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// symbol作为key</span>
<span class="token keyword">const</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'abc'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>s2<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'cc'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>第二种方式，通过添加数组方式添加。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 需要用数组方式来获取，不能通过点语法，否则会获取到字符串key</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>第三种方式，通过对象中的<code>defineProperty</code>方法添加。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> s4<span class="token operator">=</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>s4<span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span><span class="token string">'ff'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="通过symbol获取对应的值"><a href="#通过symbol获取对应的值" class="header-anchor">#</a> 通过symbol获取对应的值</h5> <p>需要用数组方式来获取，不能通过点语法，否则会获取到字符串key。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>s1<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>symbol</code>不能被隐式转换成<code>string</code>类型。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> Sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;Sym&quot;</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span>Sym<span class="token punctuation">)</span>  <span class="token comment">// TypeError: Cannot convert a Symbol value to a string</span>
</code></pre></div><p>我们不能直接<code>alert</code>一个<code>symbol</code>对象，但是我们可以通过<code>toString</code>的方式或者<code>.description</code>来获取<code>symbol</code>对象的描述符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> sym <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sym<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'a'</span>
</code></pre></div><h5 id="遍历symbol"><a href="#遍历symbol" class="header-anchor">#</a> 遍历symbol</h5> <p>在使用<code>for</code>遍历、<code>object.keys</code>中是获取不到<code>symbol</code>健的，对此<code>object</code>还提供了<code>getOwnPropertySymbols</code>方法，用于获取对象中所有symbol的key。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> sKeys<span class="token operator">=</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> skey <span class="token keyword">of</span> sKeys<span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>skey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="全局symbol对象注册"><a href="#全局symbol对象注册" class="header-anchor">#</a> 全局symbol对象注册</h5> <p>有时，我们可能需要多个<code>symbol</code>的值是一致的，我们可以通过<code>symbol</code>提供的静态方法<code>for</code>方法传入一样的描述符来使它们的值一致。</p> <h5 id="symbol-for"><a href="#symbol-for" class="header-anchor">#</a> Symbol.for</h5> <p>该方法会在使用给定键搜索运行时符号注册表中的现有符号，并在找到时返回它。否则，使用此键在全局符号注册表中创建一个新符号。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> sa<span class="token operator">=</span>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'cc'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sb<span class="token operator">=</span>Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">'cc'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sa<span class="token operator">===</span>sb<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre></div><h5 id="symbol-keyfor"><a href="#symbol-keyfor" class="header-anchor">#</a> Symbol.keyFor</h5> <p>该方法用于获取全局<code>symbol</code>的描述符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> key <span class="token operator">=</span>Symbol<span class="token punctuation">.</span><span class="token function">keyFor</span><span class="token punctuation">(</span>sb<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// c</span>
</code></pre></div><h4 id="set"><a href="#set" class="header-anchor">#</a> Set</h4> <p><code>Set</code>对象（类似数组）允许你存放任何数据类型，但里面的值不能重复。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>
s1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">// Set(4) { 10, 20, 30, 40 }</span>

s1<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span> <span class="token comment">// Set(4) { 10, 20, 30, 40 }</span>
</code></pre></div><h5 id="set常用方法"><a href="#set常用方法" class="header-anchor">#</a> Set常用方法</h5> <table><thead><tr><th>方法</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td><code>size</code></td> <td><code>set</code>对象中的数量</td> <td>返回set对象中的数量</td></tr> <tr><td><code>add</code></td> <td><code>Set</code>对象</td> <td>添加元素</td></tr> <tr><td><code>delete</code></td> <td><code>boolean</code></td> <td>删除元素</td></tr> <tr><td><code>has</code></td> <td><code>boolean</code></td> <td><code>Set</code>对象中是否存在这个值</td></tr> <tr><td><code>clear</code></td> <td>无</td> <td>清空<code>Set</code>对象中的值</td></tr></tbody></table> <h4 id="weakset"><a href="#weakset" class="header-anchor">#</a> WeakSet</h4> <p><code>WeakSet</code>是类似<code>Set</code>的另外一种数据结构，内部数据也不能有重复值。</p> <ul><li>它与<code>Set</code>的区别
<ul><li><code>WeakSet</code>只能存放对象类型，不能存放基本数据类型</li> <li><code>WeakSet</code>对元素是弱引用</li></ul></li></ul> <h5 id="基本使用"><a href="#基本使用" class="header-anchor">#</a> 基本使用</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> weakSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

weakSet<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="weakset常用方法"><a href="#weakset常用方法" class="header-anchor">#</a> WeakSet常用方法</h5> <table><thead><tr><th>方法</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td><code>add</code></td> <td><code>weakset</code>对象</td> <td>添加元素</td></tr> <tr><td><code>delete</code></td> <td><code>boolean</code></td> <td>删除元素</td></tr> <tr><td><code>has</code></td> <td><code>boolean</code></td> <td><code>weakset</code>对象中是否存在这个值</td></tr></tbody></table> <h5 id="关于遍历"><a href="#关于遍历" class="header-anchor">#</a> 关于遍历</h5> <p><code>WeakSet</code>不能被遍历，因为它只是对对象进行弱引用，如果遍历去获取元素，有可能导致对象不能被<code>GC</code>回收。</p> <p>所以<code>WeakSet</code>中的对象是不能获取的</p> <h4 id="map"><a href="#map" class="header-anchor">#</a> Map</h4> <p><code>ES6</code>新增的数据结构，用于存储映射关系。我们知道在<code>JavaScript</code>中对象中是不能用对象来作为<code>key</code>的。（假如我们把对象作为<code>key</code>，其内部会将对象转换为字符串<code>[object object]</code>）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;QC2125&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj3<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span>obj1<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'a'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>obj2<span class="token punctuation">]</span><span class="token operator">:</span><span class="token string">'b'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { '[object Object]': 'b' }</span>
</code></pre></div><p>而<code>Map</code>则可以把对象作为<code>key</code>进行存储，可以通过<code>set</code>方法添加到<code>Map</code>中，也直接通过字面量的方式添加。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;QC2125&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj2<span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Map(2) { { name: '_island' } =&gt; 'a', { name: 'QC2125' } =&gt; 'b' }</span>

<span class="token comment">// or</span>
<span class="token keyword">const</span> map2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>obj1<span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>obj2<span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="map常用方法"><a href="#map常用方法" class="header-anchor">#</a> Map常用方法</h5> <table><thead><tr><th>方法</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td><code>get</code></td> <td>获取对应的元素</td> <td>通过<code>key</code>获取对应元素</td></tr> <tr><td><code>size</code></td> <td><code>Map</code>对象中的数量</td> <td>返回<code>Map</code>对象中的数量</td></tr> <tr><td><code>set</code></td> <td><code>Map</code>对象</td> <td>添加元素</td></tr> <tr><td><code>delete</code></td> <td><code>boolean</code></td> <td>删除元素</td></tr> <tr><td><code>has</code></td> <td><code>boolean</code></td> <td><code>Set</code>对象中是否存在这个值</td></tr> <tr><td><code>clear</code></td> <td>无</td> <td>清空<code>Set</code>对象中的值</td></tr></tbody></table> <h5 id="遍历map"><a href="#遍历map" class="header-anchor">#</a> 遍历Map</h5> <p>通过<code>foreach</code>语句遍历<code>Map</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>map2<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过<code>for..of</code>遍历<code>Map</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>val<span class="token punctuation">,</span> key<span class="token punctuation">]</span> <span class="token keyword">of</span> map2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">---</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="weakmap"><a href="#weakmap" class="header-anchor">#</a> WeakMap</h4> <p>和<code>Map</code>类似，也是以键值对的形式存在的</p> <ul><li>和Map的区别
<ul><li><code>WeakMap</code>的<code>key</code>只能使用对象，不接受其他的类型作为<code>key</code></li> <li><code>WeakMap</code>的<code>key</code>对对象是弱引用</li></ul></li></ul> <h5 id="基本使用-2"><a href="#基本使用-2" class="header-anchor">#</a> 基本使用</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> weakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
weakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weakMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a</span>
</code></pre></div><h5 id="weakmap常用方法"><a href="#weakmap常用方法" class="header-anchor">#</a> WeakMap常用方法</h5> <table><thead><tr><th>方法</th> <th>返回值</th> <th>说明</th></tr></thead> <tbody><tr><td><code>get</code></td> <td><code>weakmap</code>对象</td> <td>获取元素</td></tr> <tr><td><code>delete</code></td> <td><code>boolean</code></td> <td>删除元素</td></tr> <tr><td><code>has</code></td> <td><code>boolean</code></td> <td><code>weaksmap</code>对象中是否存在这个值</td></tr></tbody></table> <h5 id="关于遍历-2"><a href="#关于遍历-2" class="header-anchor">#</a> 关于遍历</h5> <p>和<code>WeakSet</code>一样，正因为它是弱引用，<code>WeakMap</code>的<code>key</code>是不可枚举的，如果<code>key</code>可枚举那其列表将会受<code>GC</code>影响。</p> <h3 id="es7语法"><a href="#es7语法" class="header-anchor">#</a> ES7语法</h3> <h4 id="array-includes"><a href="#array-includes" class="header-anchor">#</a> array includes</h4> <p><code>includes</code>方法用于判断一个元素是否存在于一个数组中</p> <p>在之前，我们判断一个值是否在数组中，通常会使用<code>Array.indexOf</code>来进行判断，而在<code>ES7</code>之后，我们可以使用<code>Array.includes</code>进行判断。</p> <p><code>ES5</code>中使用<code>Array.indexOf</code>方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mba&quot;</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;cba&quot;</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;包含abc元素&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>ES7</code>中使用<code>Array.includes</code>方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mba&quot;</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;cba&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;包含abc元素&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于<code>NaN</code>的判断</p> <p>在<code>includes</code>方法里可以内数组中判断出是否存在<code>NaN</code>值，而<code>indexOf</code>无法正确判断出来。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;nba&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mba&quot;</span><span class="token punctuation">,</span> <span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;包含NaN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>names<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;包含NaN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="求幂运算符"><a href="#求幂运算符" class="header-anchor">#</a> 求幂运算符</h4> <p>求幂运算符（<code>**</code>）返回将第一个操作数加到第二个操作数的幂的结果。它等效于<code>Math.pow</code>，你可以理解它就和+、-运算符一样。</p> <p>在ES5的时候，我们通过求一个数的次幂通常是通过<code>Math.pow</code>方法操作的。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> result <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>现在，我们可以直接使用**运算符直接求幂。且写法简洁很多。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> result2 <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">**</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre></div><p>也可以使用<code>BigInts</code>作为操作数。</p> <h5 id="什么是bigint"><a href="#什么是bigint" class="header-anchor">#</a> 什么是BigInt</h5> <p>是一种内置对象，它可以是任意大的整数。它解决了<code>Number</code>类型的限制。</p> <p>当一个数大于<code>Number</code>类型所能表示的最大整数时，这个数会被四舍五入。那么会损害程序的可靠性和安全性。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">9007199254740992</span> <span class="token operator">===</span> <span class="token number">9007199254740993</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p>为了解决这个限制，可以使用<code>BigInt</code>类型来解决这个问题。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">&quot;9007199254740998&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 9007199254740998n</span>
</code></pre></div><p>出了使用<code>BigInt</code>构造函数创建<code>BigInt</code>类型的值，也可以在数字后面添加上<code>n</code>即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token number">9007199254740998n</span><span class="token punctuation">)</span> <span class="token comment">// bigint</span>
</code></pre></div><h5 id="与number的区别"><a href="#与number的区别" class="header-anchor">#</a> 与Number的区别</h5> <ul><li><code>BigInt</code>不能使用<code>Math</code>对象中的方法</li> <li>不能和<code>Nunber</code>进行运算</li> <li><code>BigInt</code>转<code>Number</code>类型可能出现失去精度</li></ul> <h3 id="es8语法"><a href="#es8语法" class="header-anchor">#</a> ES8语法</h3> <p><code>ES8</code>又称<code>ES2017</code>，在<code>ES6</code>之后的语法我们都统称为<code>ES6+</code>，下面我们来看看<code>ES8</code>中新增的新语法。它们都是一些非常实用的功能</p> <ul><li><code>Object.values</code></li> <li><code>Object.entries</code></li> <li>字符串填充</li> <li>函数参数的逗号</li> <li><code>Object.getOwnPropertyDescriptors</code></li> <li><code>async</code></li></ul> <h4 id="object-values"><a href="#object-values" class="header-anchor">#</a> Object values</h4> <p>该方法可以获取对象中所有的value值。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ '_island', 18 ]</span>
</code></pre></div><h4 id="object-entries"><a href="#object-entries" class="header-anchor">#</a> Object entries</h4> <p>该方法用于将一个对象的可枚举健值转换为一个数组。方便后续遍历数据</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 将一个对象转为一个数组，方便后续遍历</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ [ 'name', '_island' ], [ 'age', 18 ] ]</span>
</code></pre></div><h4 id="字符串填充"><a href="#字符串填充" class="header-anchor">#</a> 字符串填充</h4> <h4 id="函数参数的逗号"><a href="#函数参数的逗号" class="header-anchor">#</a> 函数参数的逗号</h4> <p>ES8之后，可以在函数的参数后面尾随逗号。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">m<span class="token punctuation">,</span>n<span class="token punctuation">,</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="object-getownpropertydescriptors"><a href="#object-getownpropertydescriptors" class="header-anchor">#</a> Object getOwnPropertyDescriptors</h4> <p>该方法用来获取一个对象的所有自身属性的描述符。</p> <p>返回是描述符的有以下子集的组成：</p> <table><thead><tr><th>属性</th> <th>说明</th></tr></thead> <tbody><tr><td><code>value</code></td> <td>属性值</td></tr> <tr><td><code>writable</code></td> <td>该属性是否可写</td></tr> <tr><td><code>configurable</code></td> <td>该属性是否可配置（是否可读写、删除该属性）</td></tr> <tr><td><code>enumerable</code></td> <td>该属性是否可枚举</td></tr> <tr><td><code>set</code></td> <td>设置属性时调用的函数</td></tr> <tr><td><code>get</code></td> <td>获取属性时调用的函数</td></tr></tbody></table> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// {</span>
<span class="token comment">//   name: {</span>
<span class="token comment">//     value: '_island',</span>
<span class="token comment">//     writable: true,</span>
<span class="token comment">//     enumerable: true,</span>
<span class="token comment">//     configurable: true</span>
<span class="token comment">//   }</span>
<span class="token comment">// }</span>
</code></pre></div><h4 id="async"><a href="#async" class="header-anchor">#</a> async</h4> <p><code>async</code>函数是一个异步函数，且需要搭配<code>await</code>关键字使用。它可以使<code>Promise</code>的异步执行的像同步代码一样执行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">res</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ok</span>
</code></pre></div><h3 id="es9的语法"><a href="#es9的语法" class="header-anchor">#</a> ES9的语法</h3> <p>Async iterators</p> <p>Object spread operators</p> <p>Promis finally</p> <h3 id="es10语法"><a href="#es10语法" class="header-anchor">#</a> ES10语法</h3> <h4 id="数组降维"><a href="#数组降维" class="header-anchor">#</a> 数组降维</h4> <p><code>Array.flat</code>方法会将一个数组进行降维操作，并合成一个新的数组返回。（如果没有参数传入，默认降维深度为<code>1</code>）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newNums1 <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 1, 2, 3, 4, 5, 6, [ 7, 8 ] ]</span>

<span class="token keyword">const</span> newNums2 <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4, 5, 6, 7, 8]</span>
</code></pre></div><h4 id="遍历降维"><a href="#遍历降维" class="header-anchor">#</a> 遍历降维</h4> <p><code>Array.flatMap</code>方法会将传入的函数映射到数组中的每一个元素。并返回每个元素的结果集合，再进行<code>flat</code>操作（降维深度为<code>1</code>）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> nums2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newNums3 <span class="token operator">=</span> nums2<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNums3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [ 2, 4, 6, 8, 12 ]</span>
</code></pre></div><h5 id="和array-map-的对比"><a href="#和array-map-的对比" class="header-anchor">#</a> 和Array.map()的对比</h5> <p>在一般情况下使用<code>map</code>和<code>flatMap</code>方法好像都可以。我们看下面这个案例，可以更好了解到<code>flatMap</code>的作用。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;I live in Guangzhou&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;my name is _island&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newMsg1 <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> newMsg2 <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newMsg1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [</span>
<span class="token comment">//   'hello', 'world',</span>
<span class="token comment">//   'I',     'live',</span>
<span class="token comment">//   'in',    'Guangzhou',</span>
<span class="token comment">//   'my',    'name',</span>
<span class="token comment">//   'is',    '_island'</span>
<span class="token comment">// ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newMsg2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [</span>
<span class="token comment">//   [ 'hello', 'world' ],</span>
<span class="token comment">//   [ 'I', 'live', 'in', 'Guangzhou' ],</span>
<span class="token comment">//   [ 'my', 'name', 'is', '_island' ]</span>
<span class="token comment">// ]</span>
</code></pre></div><h4 id="object-fromentries"><a href="#object-fromentries" class="header-anchor">#</a> Object fromEntries</h4> <p>Object.fromEntries方法用于将一个<code>key-value</code>的二维数组转换为一个对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: '_island', age: 18 }</span>
</code></pre></div><h4 id="trim"><a href="#trim" class="header-anchor">#</a> trim</h4> <p>在<code>ES10</code>中对字符串对象新增了<code>trimStart</code>、<code>trimEnd</code>方法，用于处理字符串前、后的空格内容。</p> <div class="language- extra-class"><pre class="language-text"><code>const str6 = &quot;  _island  &quot;;
console.log(str6.trimStart()); // '_island  '
console.log(str6.trimEnd()); // '  _island'
</code></pre></div><h4 id="symbol-description"><a href="#symbol-description" class="header-anchor">#</a> Symbol description</h4> <p>在<code>ES10</code>中，<code>Symbol</code>类型可以声明时传入一个<code>Symbol</code>描述符。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;Symbol描述符&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="可选的catch的参数"><a href="#可选的catch的参数" class="header-anchor">#</a> 可选的Catch的参数</h4> <p>在过去try语句中catch子句必须接受一个错误参数，而在ES10中，我们可以不创建这个错误参数也可以正常允许。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 之前的写法</span>
<span class="token keyword">try</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// ES10之后的写法</span>
<span class="token keyword">try</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="更友好的string-tostring"><a href="#更友好的string-tostring" class="header-anchor">#</a> 更友好的String.toString</h4> <p>ES10之后，<code>toString</code>方法会返回精确的字符，这包括空格和注释。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token comment">/* _island */</span> foo <span class="token comment">/* age 18 */</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 之前</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function foo(){}</span>
<span class="token comment">// ES10之后</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function /* comment */ foo /* another comment */() {}</span>
</code></pre></div><h3 id="es11"><a href="#es11" class="header-anchor">#</a> ES11</h3> <h5 id="bigint"><a href="#bigint" class="header-anchor">#</a> BigInt</h5> <h5 id="空值合并"><a href="#空值合并" class="header-anchor">#</a> 空值合并</h5> <p>可选链</p> <p>全局this</p> <p>动态导入</p> <p>promise.allSettled</p> <p>import mate</p> <h3 id="es12"><a href="#es12" class="header-anchor">#</a> ES12</h3> <p>FinalizationRegistry</p> <p>WeakRef</p> <p>字符串分隔符</p> <p>逻辑与</p> <p>replaceAll</p> <h3 id="proxy"><a href="#proxy" class="header-anchor">#</a> Proxy</h3> <h4 id="监听对象操作"><a href="#监听对象操作" class="header-anchor">#</a> 监听对象操作</h4> <p>某些场景下，需要监听一个对象的操作，当这个操作触发时执行另外的一个函数，就像vue2中的watchApi，它可以监听data数据中某个属性的改变并操作指定的函数。</p> <p>我们看看下面这份代码，使用Object.defineProperty（对象属性描述符）对对象的监听，将一个对象进行遍历，并设定getter、setter方法进行监听和拦截。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> val<span class="token operator">=</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token operator">+</span><span class="token string">&quot;调用了get方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> val
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token operator">+</span><span class="token string">&quot;调用了set方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      val<span class="token operator">=</span>newVal
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

obj<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'QC2125'</span>
obj<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">30</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过这种方式监听的缺点</p> <ul><li><code>Object.defineProperty</code>的设计初衷并不是为了去监听拦截一个对象中的属性</li> <li>也实现不了更加丰富的操作，比如添加、删除属性</li></ul> <h4 id="认识proxy"><a href="#认识proxy" class="header-anchor">#</a> 认识Proxy</h4> <p><code>Proxy</code>对象用于创建一个对象的代理，是用于监听一个对象的相关操作。代理对象可以监听我们对原对象的操作。</p> <p>接下来我们将通过一个监听对象的属性操作来认识学习下什么是<code>Proxy</code>。</p> <p>Proxy对象需要传入两个参数，分别是需要被<code>Proxy</code>代理的对象和一系列的捕获器（后面会讲）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj<span class="token operator">=</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">'_island'</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> objProxy<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://gitee.com/QC2168/note-img/raw/master/202202042003373.png" alt="image-20220204200341915"></p> <p>打印出来可以看到的是一个<code>Proxy</code>对象。下面我们开始看看<code>Proxy</code>中的捕获器对象。</p> <h4 id="捕获器"><a href="#捕获器" class="header-anchor">#</a> 捕获器</h4> <p>Proxy捕获共有<code>13</code>个，它们用于我们对对象、函数的方法调用监听。</p> <table><thead><tr><th>对象中的方法</th> <th>对应触发条件</th></tr></thead> <tbody><tr><td>handler.getPrototypeOf()</td> <td><code>Object.getPrototypeOf</code> 方法的捕捉器</td></tr> <tr><td>handler.setPrototypeOf()</td> <td><code>Object.setPrototypeOf</code> 方法的捕捉器</td></tr> <tr><td>handler.isExtensible()</td> <td><code>Object.isExtensible</code> 方法的捕捉器</td></tr> <tr><td>handler.preventExtensions()</td> <td><code>Object.preventExtensions</code> 方法的捕捉器</td></tr> <tr><td>handler.getOwnPropertyDescriptor()</td> <td><code>Object.getOwnPropertyDescriptor</code> 方法的捕捉器。</td></tr> <tr><td>handler.defineProperty()</td> <td><code>Object.defineProperty</code> 方法的捕捉器</td></tr> <tr><td>handler.has()</td> <td><code>in</code> 操作符的捕捉器</td></tr> <tr><td>handler.get()</td> <td>属性读取操作的捕捉器</td></tr> <tr><td>handler.set()</td> <td>属性设置操作的捕捉器</td></tr> <tr><td>handler.deleteProperty()</td> <td><code>delete</code> 操作符的捕捉器</td></tr> <tr><td>handler.ownKeys()</td> <td><code>Object.getOwnPropertyNames</code> 方法和 <code>Object.getOwnPropertySymbols</code> 方法的捕捉器</td></tr> <tr><td>handler.apply()</td> <td>函数被<code>apply</code>调用操作的捕捉器</td></tr> <tr><td>handler.construct()</td> <td><code>new</code> 操作符的捕捉器</td></tr></tbody></table> <p>在实例化Proxy对象时，第二个参数传入的是捕获器集合，我们在其对象内定义一个<code>get</code>捕获器，用于监听获取对象值的操作。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 定义一个普通的对象obj</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 代理obj这个对象，并传入get捕获器</span>
<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// get捕获器</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">捕获到对象获取</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">属性的值操作</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过代理对象操作obj对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 捕获到对象获取name属性的值操作</span>
<span class="token comment">// _island</span>
</code></pre></div><p><code>get</code><strong>捕获器会被继承</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> proto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;GET &quot;</span> <span class="token operator">+</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>proto<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// GET foo</span>
</code></pre></div><p>新增另外一个捕获器<code>set</code>，用于监听对象的某个属性被设置时触发。在这里你可以判断一个对象属性即将被设定的值是否符合预期等业务处理。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// set捕获器</span>
<span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">捕获到对象设置</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">属性的值操作,新值为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;QC2125&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 捕获到对象设置name属性的值操作,新值为QC2125</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 捕获到对象获取name属性的值操作</span>
<span class="token comment">// QC2125</span>
</code></pre></div><p>我们也可以监听对象是否调用了<code>Object.getPrototypeOf</code>、<code>Object.prototype.__proto__</code>、<code>Object.prototype.isPrototypeOf</code>、<code>Reflect.getPrototypeOf</code>、<code>instanceof</code>操作，使用<code>getPrototypeOf</code>捕获器即可。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 监听getPrototypeOf</span>
<span class="token function-variable function">getPrototypeOf</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到对象获取原型操作</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h4 id="对象监听案例"><a href="#对象监听案例" class="header-anchor">#</a> 对象监听案例</h4> <p>在<code>ES5</code>之前，我们监听对象的操作方式是通过<code>Object.defineProperty</code>方法来实现的。我们看下面这个案例。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 定义一个Object对象</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> val <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot;调用了get方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key <span class="token operator">+</span> <span class="token string">&quot;调用了set方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 操作obj对象</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;QC2125&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// name调用了set方法</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token comment">// age调用了set方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// name调用了get方法</span>
<span class="token comment">// QC2125</span>
</code></pre></div><p><code>Object.defineProperty</code>的设计初衷并不是为了去监听拦截一个对象中的属性，且他也实现不了更加丰富的操作，例如添加、删除属性等操作。所以在ES6中新增了<code>Proxy</code>对象，用于监听<code>Object</code>、<code>Function</code>的操作。</p> <p>我们将上面通过<code>Object.defineProperty</code>实现对象监听的方法修改成<code>Proxy</code>方案。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取值时的捕获器</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到了</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">被获取值</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 设置值时的捕获器</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到了</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">被设置值</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 监听到了name被获取值</span>
<span class="token comment">// _island</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 监听到了age被获取值</span>
<span class="token comment">// 18</span>
objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;QC2125&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 监听到了name被设置值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 监听到了name被获取值</span>
<span class="token comment">// QC2125</span>
</code></pre></div><h3 id="reflect"><a href="#reflect" class="header-anchor">#</a> Reflect</h3> <p><code>Reflect</code>是一个对象，翻译过来是反射的意思，它提供了很多操作<code>JavaScript</code>对象的方法， 是为了弥补<code>Object</code>中对象的一些缺陷。且所有属性和方法都是静态的</p> <h4 id="为什么会有reflect"><a href="#为什么会有reflect" class="header-anchor">#</a> 为什么会有Reflect</h4> <p>在早期，<code>JavaScript</code>这门语言中的一些内部方法都被部署到了<code>Object</code>这个对象上。就例如<code>getPrototype</code>、<code>deinfeProperty</code>等<code>API</code>、类似<code>in</code>、<code>delete</code>操作符都放到了<code>Object</code>对象上了。但<code>Object</code>作为一个构造函数（<code>Reflect</code>并非一个构造函数，不能通过new关键字调用），这些方法放到它身上并不合适，所以在<code>ES6</code>之后的内部新方法会部署到<code>Reflect</code>对象中。</p> <h4 id="使用reflect对象操作object对象"><a href="#使用reflect对象操作object对象" class="header-anchor">#</a> 使用Reflect对象操作Object对象</h4> <p>Reflect对象让我们操作<code>Object</code>对象不再是通过点语法了，而是变成了函数行为。</p> <p>我们看下面的例子，获取对象属性可以使用<code>Reflect.get</code>方法、将对象的属性赋值可以使用<code>Reflect.set</code>方法。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 获取对应属性的值</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// _island</span>

<span class="token comment">// 对对象的属性赋值操作</span>
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// abc</span>


<span class="token comment">// 判断一个对象中是否有该属性</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span> <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Reflect<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><h4 id="reflect中的方法"><a href="#reflect中的方法" class="header-anchor">#</a> Reflect中的方法</h4> <table><thead><tr><th>对象中的方法</th> <th>说明</th></tr></thead> <tbody><tr><td>Reflect.apply()</td> <td>对一个函数进行apply调用</td></tr> <tr><td>Reflect.construct()</td> <td>对构造函数进行new操作</td></tr> <tr><td>Reflect.defineProperty()</td> <td>定义一个属性</td></tr> <tr><td>Reflect.deleteProperty()</td> <td>删除一个属性</td></tr> <tr><td>Reflect.get()</td> <td>获取一个属性</td></tr> <tr><td>Reflect.getOwnPropertyDescriptor()</td> <td>获取一个属性描述符</td></tr> <tr><td>Reflect.getPrototypeOf()</td> <td>获取一个对象的原型</td></tr> <tr><td>Reflect.has()</td> <td>判断一个属性是否在对象中</td></tr> <tr><td>Reflect.isExtensible()</td> <td>判断可以扩展</td></tr> <tr><td>Reflect.ownKeys()</td> <td>获取一个对象中的key集合</td></tr> <tr><td>Reflect.preventExtensions()</td> <td>使一个对象不可扩展</td></tr> <tr><td>Reflect.set()</td> <td>设置一个属性</td></tr> <tr><td>Reflect.setPrototypeOf()</td> <td>设置一个对象的原型</td></tr></tbody></table> <p><code>Reflect</code>对象中一些方法与<code>Object</code>相同，但它们存在一些细微的区别，如果你想更加了解可以阅读<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect/Comparing_Reflect_and_Object_methods" target="_blank" rel="noopener noreferrer">Reflect和Object中的方法区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>在返回值方便<code>Reflect</code>对象中的方法设计的更加合理。比如<code>defineProperty</code>方法，如果没有将属性设置成功，在<code>Reflect</code>中会返回<code>boolean</code>值，而<code>Object</code>对象中如果没有定义成功则会抛出<code>TypeError</code>。</p> <h4 id="reflect搭配proxy"><a href="#reflect搭配proxy" class="header-anchor">#</a> Reflect搭配Proxy</h4> <p><code>Reflect</code>对象中的方法和上一篇文章将到的<code>Proxy</code>对象的方法的对应的，<code>Proxy</code>对象中的方法也能在<code>Reflect</code>对象中调用。</p> <p>通常我们将<code>Reflect</code>对象搭配<code>Proxy</code>一起使用，我们看下面这个<code>Reflect</code>搭配<code>Proxy</code>对象使用的案例。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 原来的写法</span>
    <span class="token comment">// return target[key]</span>
    <span class="token comment">// 使用Reflect</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newVal<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 原来的写法</span>
    <span class="token comment">// target[key]=newVal</span>
    <span class="token comment">// 使用Reflect</span>
    Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newVal<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// abc</span>
</code></pre></div><p>在上面，<code>Proxy</code>对象中<code>get</code>、<code>set</code>捕获器多了一个<code>receiver</code>参数，这是这两个捕获器特有的，这个<code>receiver</code>参数是当前代理的目标。</p> <p>当<code>Proxy</code>和<code>Reflect</code>搭配使用时，<code>Proxy</code>对象会拦截对应的操作，后者完成对应的操作，如果传入<code>receiver</code>，那么<code>Reflect.get</code>属性会触发<code>Proxy.defineProperty</code>捕获器。我们再上面这里案例上再新增一些代码。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;_island&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> objProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 原来的写法</span>
    <span class="token comment">// return target[key]</span>
    <span class="token comment">// 使用Reflect</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newVal<span class="token punctuation">,</span> receiver</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 原来的写法</span>
    <span class="token comment">// target[key]=newVal</span>
    <span class="token comment">// 使用Reflect</span>
    Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> newVal<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">defineProperty</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> attr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;defineProperty&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Reflect<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

objProxy<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>objProxy<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// defineProperty</span>
<span class="token comment">// { name: '_island' } name { value: 'abc' }</span>
<span class="token comment">// { name: 'abc' }</span>
<span class="token comment">// abc</span>
</code></pre></div><p>传入在我们获取代理对象中的<code>name</code>属性时，当<code>Reflect</code>有<code>receiver</code>参数传入时，获取属性值时会获取到<code>receiver</code>中的，所以会触发<code>defineProperty</code>捕获器，如果没有传入<code>receiver</code>参数，则不会触发<code>defineProperty</code>捕获器。</p> <h4 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h4> <ul><li><code>Reflect</code>对象中集合了<code>JavaScript</code>内部方法</li> <li>操作<code>Object</code>对象的方式变成了函数行为</li> <li><code>Reflect</code>对象中的方法返回结果更加合理</li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-8dd7aa56></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-2a01419c data-v-2a01419c><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-2a01419c><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-2a01419c></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-2a01419c></path></svg></div></div></div>
    <script src="/record/assets/js/app.436f9468.js" defer></script><script src="/record/assets/js/3.c10ff59d.js" defer></script><script src="/record/assets/js/1.128bb0a8.js" defer></script><script src="/record/assets/js/62.1d933bdb.js" defer></script>
  </body>
</html>
